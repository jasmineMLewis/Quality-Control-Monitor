Imports System.Data.SqlClient
Imports System.IO
Imports System.Web.Configuration

Public Class Statistical_Report
    Inherits System.Web.UI.Page
    Dim conn As New SqlConnection(WebConfigurationManager.ConnectionStrings("QualityControlMonitorConnectionString").ConnectionString)
    Public Const ADMIN As Integer = 1
    Public Const AUDITOR_ID As Integer = 2
    Public Const HOUSING_SPECALIST As Integer = 3

    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        'Dim sessionUserID As String = GetSessionUserID()
        'Dim sessionUserRoleID As Integer = GetUserRoleID(sessionUserID)

        'If sessionUserRoleID = HOUSING_SPECALIST Then
        ';DisplayListingsBasedOnHousingSpecialist(sessionUserID)
        'End If

        If Not IsPostBack Then
            SetFiltersToAll()
        End If
    End Sub

    Private Sub BindGridWithFilters()
        Dim sql As String = ""

        Dim fileStaffID As Integer = FileStaff.SelectedValue
        Dim auditorID As Integer = Auditor.SelectedValue
        Dim groupID As Integer = Group.SelectedValue
        Dim reviewDateBeginUnconverted As String = ReviewDateBegin.Text
        Dim reviewDateEndUnconverted As String = ReviewDateEnd.Text
        Dim reviewDateBeginConverted As String = ConvertStringFormatDatetoSqlDate(reviewDateBeginUnconverted)
        Dim reviewDateEndConverted As String = ConvertStringFormatDatetoSqlDate(reviewDateEndUnconverted)

        Dim sessionUserID As String = GetSessionUserID()
        Dim sessionUserRoleID As Integer = GetUserRoleID(sessionUserID)

        Select Case sessionUserRoleID
            Case ADMIN To AUDITOR_ID

                If (auditorID > 0) And (fileStaffID > 0) Then
                    sql = "SELECT COUNT(FileID) AS TotalReviews, " &
                                     "   TotalReviewsWithErrors = (SELECT COUNT(DISTINCT(fk_FileID))  " &
                                     "                             FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                     "   TotalReviewsWithErrorsPercent = ROUND((((SELECT COUNT(DISTINCT(fk_FileID)) " &
                                     "                                   FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                   ISNULL(NULLIF((SELECT COUNT(FileID) FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'),0),1)), 3), " &
                                     "   TotalReviewsWithNoErrors = ((SELECT COUNT(FileID) FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') - " &
                                     "                               (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')), " &
                                     "   TotalReviewsWithNoErrorsPercent = ROUND(((((SELECT COUNT(FileID) FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') - " &
                                     "                                     (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'))  * 100.0) / " &
                                     "                                     ISNULL(NULLIF((SELECT COUNT(FileID) FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'),0),1)), 3),  " &
                                     "   TotalNumberOfPendingErrors = ((SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE Status = 'Pending' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')), " &
                                     "   TotalNumberOfCompleteErrors = ((SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE Status = 'Complete' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')), " &
                                     "   TotalNumberOfAllErrors = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                     "" &
                                     "    TotalNumberOfNoticeTypeError = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '1' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                     "    TotalNumberOfNoticeTypeWarning = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '2' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                     "    TotalNumberOfNoticeTypeMissing = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '3' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                     "    TotalNumberOfNoticeTypeNoError = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '4' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                     "    TotalNumberOfNoticeTypeOther = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '5' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                     "    TotalNumberOfNoticeTypeIncome = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '6' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                     "    TotalNumberOfNoticeTypeAdjustedIncome = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '7' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                     "    TotalNumberOfNoticeTypePaymentStandard = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '8' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                     "    TotalNumberOfNoticeTypeUtilityAllowance = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '9' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                     "    TotalNumberOfNoticeTypeContractRent = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '10' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                     "    TotalNumberOfNoticeTypeIncomeOrAdjustedRent = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '11' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                     "" &
                                     "   TotalNumberOfReviewsWithVerification = (SELECT COUNT(*) AS NumberOfReviewsWithVerificationType FROM " &
                                     "                                          (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                          (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '1')) Files),  " &
                                     "   TotalNumberOfReviewsWithVerificationErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '1' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                     "	PercentOfReviewsWithVerificationErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '1' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                            ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithVerificationType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                            (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '1')) Files),0),1),3), " &
                                     "" &
                                     "   TotalNumberOfReviewsWithCalculation = (SELECT COUNT(*) AS NumberOfReviewsWithCalculationType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                         (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '2')) Files)," &
                                     "   TotalNumberOfReviewsWithCalculationErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '2' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                     "   PercentOfReviewsWithCalculationErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '2' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                           ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithCalculationType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                           (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '2')) Files),0),1),3), " &
                                     "" &
                                     "   TotalNumberOfReviewsWithPaymentStandard = (SELECT COUNT(*) AS NumberOfReviewsWithPaymentStandardType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                             (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '3')) Files), " &
                                     "   TotalNumberOfReviewsWithPaymentStandardErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '3' AND fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_Auditor_SubmittedID = '" & auditorID & "')," &
                                     "	PercentOfReviewsWithPaymentStandardErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '3' AND fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_Auditor_SubmittedID = '" & auditorID & "') * 100.0) / " &
                                     "                                               ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithPaymentStandardType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                               (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '3')) Files),0),1),3), " &
                                     "" &
                                     "   TotalNumberOfReviewsWithUtilityAllowance = (SELECT COUNT(*) AS NumberOfReviewsWithUtilityAllowance FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                              (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '4')) Files), " &
                                     "   TotalNumberOfReviewsWithUtilityAllowanceErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '4' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                     "   PercentOfReviewsWithUtilityAllowanceErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '4' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                                ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithUtilityAllowanceType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                               (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '4')) Files),0),1),3), " &
                                     "" &
                                     "	TotalNumberOfReviewsWithTenantRent = (SELECT COUNT(*) AS NumberOfReviewsWithTenantRent FROM	(SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                        (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '5')) Files), " &
                                     "   TotalNumberOfReviewsWithTenantRentErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '5' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                     "   PercentOfReviewsWithTenantRentErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '5' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                          ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithTenantRentType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                          (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '5')) Files),0),1),3), " &
                                     "" &
                                     "   TotalNumberOfReviewsWithOccupanyStandard = (SELECT COUNT(*) AS NumberOfReviewsWithOccupanyStandard FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                              (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '6')) Files),  " &
                                     "   TotalNumberOfReviewsWithOccupanyStandardErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '6' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                     "   PercentOfReviewsWithOccupanyStandardErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '6' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                                ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithOccupanyStandardType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                                (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '6')) Files),0),1),3), " &
                                     "" &
                                     "   TotalNumberOfReviewsWithAnnualReexamination = (SELECT COUNT(*) AS NumberOfReviewsWithAnnualReexamination FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                                (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '7')) Files), " &
                                     "   TotalNumberOfReviewsWithAnnualReexaminationErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '7' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                     "   PercentOfReviewsWithAnnualReexaminationErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '7' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                                   ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithAnnualReexaminationType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                                   (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '7')) Files),0),1),3)," &
                                     "" &
                                     "   TotalNumberOfReviewsWithInterimReexamination = (SELECT COUNT(*) AS NumberOfReviewsWithInterimReexamination FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                                 (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '8')) Files)," &
                                     "   TotalNumberOfReviewsWithInterimReexaminationErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '8' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                     "   PercentOfReviewsWithInterimReexaminationErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID	WHERE fk_ProcessTypeID = '8' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                                    ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithInterimReexaminationType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                                    (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '8')) Files),0),1),3)," &
                                     "" &
                                     "   TotalNumberOfReviewsWithMoves = (SELECT COUNT(*) AS NumberOfReviewsWithMoves FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                   (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '9')) Files)," &
                                     "   TotalNumberOfReviewsWithMovesErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '9' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                     "   PercentOfReviewsWithMovesErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '9' AND fk_ErrorStaffID = '" & fileStaffID & "'  AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                     ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithMovesType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "'  AND fk_AudtitorID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                     (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '9')) Files),0),1),3), " &
                                     "" &
                                     "   TotalNumberOfReviewsWithChangeInFamilyComposition = (SELECT COUNT(*) AS NumberOfReviewsWithChangeInFamilyComposition FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '10')) Files), " &
                                     "   TotalNumberOfReviewsWithChangeInFamilyCompositionErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '10' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                     "   PercentOfReviewsWithChangeInFamilyCompositionErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '10' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                                         ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithChangeInFamilyCompositionType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                                         (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '10')) Files),0),1),3), " &
                                     "" &
                                     "   TotalNumberOfReviewsWithEligibilityAndScreening = (SELECT COUNT(*) AS NumberOfReviewsWithEligibilityAndScreening FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '11')) Files), " &
                                     "   TotalNumberOfReviewsWithEligibilityAndScreeningErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '11' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                     "   PercentOfReviewsWithEligibilityAndScreeningErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '11' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                                       ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithEligibilityAndScreeningType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '11')) Files),0),1),3), " &
                                     "" &
                                     "   TotalNumberOfReviewsWithLeasing =                   (SELECT COUNT(*) AS NumberOfReviewsWithLeasing FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '12')) Files), " &
                                     "   TotalNumberOfReviewsWithLeasingErrors =             (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '12' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                     "   PercentOfReviewsWithLeasingErrors =                 ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '12' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                                       ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithLeasingType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '12')) Files),0),1),3), " &
                                     "" &
                                     "   TotalNumberOfReviewsWithDataEntry =                 (SELECT COUNT(*) AS NumberOfReviewsWithDataEntry FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '13')) Files), " &
                                     "   TotalNumberOfReviewsWithDataEntryErrors =           (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '13' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                     "   PercentOfReviewsWithDataEntryErrors =               ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '13' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                                       ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithDataEntryType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '13')) Files),0),1),3), " &
                                     "" &
                                     "   TotalNumberOfReviewsWithOther =                     (SELECT COUNT(*) AS NumberOfReviewsWithOther FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '21')) Files), " &
                                     "   TotalNumberOfReviewsWithOtherErrors =               (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '21' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                     "   PercentOfReviewsWithOtherErrors =                   ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '21' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                                       ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithOtherType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '21')) Files),0),1),3), " &
                                     "" &
                                     "   TotalNumberOfReviewsWithSelectionFromTheWaitlist =  (SELECT COUNT(*) AS NumberOfReviewsWithSelectionFromTheWaitlist FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '22')) Files), " &
                                     "   TotalNumberOfReviewsWithSelectionFromTheWaitlistErrors =  (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '22' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                     "   PercentOfReviewsWithSelectionFromTheWaitlistErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '22' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                                       ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithSelectionFromTheWaitlistType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '22')) Files),0),1),3), " &
                                     "" &
                                     "   TotalNumberOfReviewsWithReasonableRent =  (SELECT COUNT(*) AS NumberOfReviewsWithReasonableRent FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                             (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '15')) Files), " &
                                     "   TotalNumberOfReviewsWithReasonableRentErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '15' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                     "   PercentOfReviewsWithReasonableRentErrors  = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '15' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                               ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithReasonableRentType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'  AND fk_ReviewTypeID IN " &
                                     "                                               (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '15')) Files),0),1),3), " &
                                     "" &
                                     "   TotalNumberOfReviewsWithPortability = (SELECT COUNT(*) AS NumberOfReviewsWithPortability FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                         (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '16')) Files), " &
                                     "   TotalNumberOfReviewsWithPortabilityErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '16' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                     "   PercentOfReviewsWithPortabilityErrors  = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '16' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                            ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithPortabilityType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                            (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '16')) Files),0),1),3), " &
                                     "" &
                                     "   TotalNumberOfReviewsWithLotteryNumber = (SELECT COUNT(FileID) FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND fk_ReviewTypeID = '7' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                     "   TotalNumberOfReviewsWithLotteryNumberErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM LotteryNumberErrors INNER JOIN Files ON LotteryNumberErrors.fk_FileID = Files.FileID WHERE Files.fk_CaseManagerID = '" & fileStaffID & "' AND LotteryNumberErrors.fk_AuditorID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                     "   PercentOfReviewsWithLotteryNumberErrors = ROUND((((SELECT COUNT(DISTINCT(fk_FileID)) FROM LotteryNumberErrors INNER JOIN Files ON LotteryNumberErrors.fk_FileID = Files.FileID  WHERE Files.fk_CaseManagerID = '" & fileStaffID & "' AND LotteryNumberErrors.fk_AuditorID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                             ISNULL(NULLIF((SELECT COUNT(FileID) FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND  fk_ReviewTypeID = '7' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'),0),1)), 3), " &
                                     "" &
                                     "   TotalNumberOfReviewsWithPortIn = (SELECT COUNT(FileID) FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND fk_ReviewTypeID = '7' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                     "   TotalNumberOfReviewsWithPortInErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM SpecialCaseErrors INNER JOIN Files ON SpecialCaseErrors.fk_FileID = Files.FileID WHERE Files.fk_CaseManagerID = '" & fileStaffID & "' AND fk_ErrorTypeID = '20' AND fk_AuditorID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                     "   PercentOfReviewsWithPortInErrors = ROUND((((SELECT COUNT(DISTINCT(fk_FileID)) FROM SpecialCaseErrors INNER JOIN Files ON SpecialCaseErrors.fk_FileID = Files.FileID WHERE Files.fk_CaseManagerID = '" & fileStaffID & "' AND fk_ErrorTypeID = '20' AND fk_AuditorID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                                ISNULL(NULLIF((SELECT COUNT(FileID) FROM Files  WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID = '7' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'),0),1)), 3), " &
                                     "" &
                                     "   TotalNumberOfReviewsWithSpecialAdmission = (SELECT COUNT(FileID) FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID = '7' AND fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                     "   TotalNumberOfReviewsWithSpecialAdmissionErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM SpecialCaseErrors INNER JOIN Files ON SpecialCaseErrors.fk_FileID = Files.FileID WHERE Files.fk_CaseManagerID = '" & fileStaffID & "' AND fk_ErrorTypeID = '19' AND fk_AuditorID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                     "   PercentOfReviewsWithSpecialAdmissionErrors = ROUND((((SELECT COUNT(DISTINCT(fk_FileID)) FROM SpecialCaseErrors INNER JOIN Files ON SpecialCaseErrors.fk_FileID = Files.FileID WHERE Files.fk_CaseManagerID = '" & fileStaffID & "' AND fk_ErrorTypeID = '19' AND fk_AuditorID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                                ISNULL(NULLIF((SELECT COUNT(FileID) FROM Files  WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND fk_ReviewTypeID = '7' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'),0),1)), 3), " &
                                     "" &
                                     "   TotalNumberOfReviewsWithDocumentErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '18' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                     "   PercentOfReviewsWithDocumentErrors = ROUND((((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '18' AND fk_ErrorStaffID = '" & fileStaffID & "' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                        ISNULL(NULLIF((SELECT COUNT(FileID) FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'),0),1)), 3) " &
                                     "" &
                                     "FROM Files   " &
                                     "WHERE FileID != '0' AND fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "'"

                ElseIf (fileStaffID > 0) Then
                    sql = "SELECT COUNT(FileID) AS TotalReviews, " &
                                     "   TotalReviewsWithErrors = (SELECT COUNT(DISTINCT(fk_FileID))  " &
                                     "                             FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                     "   TotalReviewsWithErrorsPercent = ROUND((((SELECT COUNT(DISTINCT(fk_FileID)) " &
                                     "                                   FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                   ISNULL(NULLIF((SELECT COUNT(FileID) FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'),0),1)), 3), " &
                                     "   TotalReviewsWithNoErrors = ((SELECT COUNT(FileID) FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') - " &
                                     "                               (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')), " &
                                     "   TotalReviewsWithNoErrorsPercent = ROUND(((((SELECT COUNT(FileID) FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') - " &
                                     "                                     (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'))  * 100.0) / " &
                                     "                                     ISNULL(NULLIF((SELECT COUNT(FileID) FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'),0),1)), 3),  " &
                                     "   TotalNumberOfPendingErrors = ((SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE Status = 'Pending' AND fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')), " &
                                     "   TotalNumberOfCompleteErrors = ((SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE Status = 'Complete' AND fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')), " &
                                     "   TotalNumberOfAllErrors = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                     "" &
                                     "    TotalNumberOfNoticeTypeError = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '1' AND fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                     "    TotalNumberOfNoticeTypeWarning = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '2' AND fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                     "    TotalNumberOfNoticeTypeMissing = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '3' AND fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                     "    TotalNumberOfNoticeTypeNoError = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '4' AND fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                     "    TotalNumberOfNoticeTypeOther = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '5' AND fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                     "    TotalNumberOfNoticeTypeIncome = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '6' AND fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                     "    TotalNumberOfNoticeTypeAdjustedIncome = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '7' AND fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                     "    TotalNumberOfNoticeTypePaymentStandard = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '8' AND fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                     "    TotalNumberOfNoticeTypeUtilityAllowance = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '9' AND fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                     "    TotalNumberOfNoticeTypeContractRent = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '10' AND fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                     "    TotalNumberOfNoticeTypeIncomeOrAdjustedRent = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '11' AND fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                     "" &
                                     "   TotalNumberOfReviewsWithVerification = (SELECT COUNT(*) AS NumberOfReviewsWithVerificationType FROM " &
                                     "                                          (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                          (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '1')) Files),  " &
                                     "   TotalNumberOfReviewsWithVerificationErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '1' AND fk_ErrorStaffID = '" & fileStaffID & "'  AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                     "	PercentOfReviewsWithVerificationErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '1' AND fk_ErrorStaffID = '" & fileStaffID & "'  AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                            ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithVerificationType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                            (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '1')) Files),0),1),3), " &
                                     "" &
                                     "   TotalNumberOfReviewsWithCalculation = (SELECT COUNT(*) AS NumberOfReviewsWithCalculationType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                         (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '2')) Files)," &
                                     "   TotalNumberOfReviewsWithCalculationErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '2' AND fk_ErrorStaffID = '" & fileStaffID & "'  AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                     "   PercentOfReviewsWithCalculationErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '2' AND fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                           ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithCalculationType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                           (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '2')) Files),0),1),3), " &
                                     "" &
                                     "   TotalNumberOfReviewsWithPaymentStandard = (SELECT COUNT(*) AS NumberOfReviewsWithPaymentStandardType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                             (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '3')) Files), " &
                                     "   TotalNumberOfReviewsWithPaymentStandardErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '3' AND fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                     "	PercentOfReviewsWithPaymentStandardErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '3' AND fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                               ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithPaymentStandardType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                               (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '3')) Files),0),1),3), " &
                                     "" &
                                     "   TotalNumberOfReviewsWithUtilityAllowance = (SELECT COUNT(*) AS NumberOfReviewsWithUtilityAllowance FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                              (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '4')) Files), " &
                                     "   TotalNumberOfReviewsWithUtilityAllowanceErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '4' AND fk_ErrorStaffID = '" & fileStaffID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                     "   PercentOfReviewsWithUtilityAllowanceErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '4' AND fk_ErrorStaffID = '" & fileStaffID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                                ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithUtilityAllowanceType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                               (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '4')) Files),0),1),3), " &
                                     "" &
                                     "	TotalNumberOfReviewsWithTenantRent = (SELECT COUNT(*) AS NumberOfReviewsWithTenantRent FROM	(SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                        (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '5')) Files), " &
                                     "   TotalNumberOfReviewsWithTenantRentErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '5' AND fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                     "   PercentOfReviewsWithTenantRentErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '5' AND fk_ErrorStaffID = '" & fileStaffID & "'  AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                          ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithTenantRentType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "'  AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                          (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '5')) Files),0),1),3), " &
                                     "" &
                                     "   TotalNumberOfReviewsWithOccupanyStandard = (SELECT COUNT(*) AS NumberOfReviewsWithOccupanyStandard FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                              (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '6')) Files),  " &
                                     "   TotalNumberOfReviewsWithOccupanyStandardErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '6' AND fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                     "   PercentOfReviewsWithOccupanyStandardErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '6' AND fk_ErrorStaffID = '" & fileStaffID & "'  AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                                ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithOccupanyStandardType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                                (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '6')) Files),0),1),3), " &
                                     "" &
                                     "   TotalNumberOfReviewsWithAnnualReexamination = (SELECT COUNT(*) AS NumberOfReviewsWithAnnualReexamination FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                                (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '7')) Files), " &
                                     "   TotalNumberOfReviewsWithAnnualReexaminationErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '7' AND fk_ErrorStaffID = '" & fileStaffID & "'  AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                     "   PercentOfReviewsWithAnnualReexaminationErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '7' AND fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                                   ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithAnnualReexaminationType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                                   (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '7')) Files),0),1),3)," &
                                     "" &
                                     "   TotalNumberOfReviewsWithInterimReexamination = (SELECT COUNT(*) AS NumberOfReviewsWithInterimReexamination FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                                 (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '8')) Files)," &
                                     "   TotalNumberOfReviewsWithInterimReexaminationErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '8' AND fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                     "   PercentOfReviewsWithInterimReexaminationErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID	WHERE fk_ProcessTypeID = '8' AND fk_ErrorStaffID = '" & fileStaffID & "'  AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                                    ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithInterimReexaminationType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                                    (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '8')) Files),0),1),3)," &
                                     "" &
                                     "   TotalNumberOfReviewsWithMoves = (SELECT COUNT(*) AS NumberOfReviewsWithMoves FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                   (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '9')) Files)," &
                                     "   TotalNumberOfReviewsWithMovesErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '9' AND fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                     "   PercentOfReviewsWithMovesErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '9' AND fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                     ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithMovesType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                     (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '9')) Files),0),1),3), " &
                                     "" &
                                     "   TotalNumberOfReviewsWithChangeInFamilyComposition = (SELECT COUNT(*) AS NumberOfReviewsWithChangeInFamilyComposition FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '10')) Files), " &
                                     "   TotalNumberOfReviewsWithChangeInFamilyCompositionErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '10' AND fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                     "   PercentOfReviewsWithChangeInFamilyCompositionErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '10' AND fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                                         ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithChangeInFamilyCompositionType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                                         (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '10')) Files),0),1),3), " &
                                     "" &
                                     "   TotalNumberOfReviewsWithEligibilityAndScreening = (SELECT COUNT(*) AS NumberOfReviewsWithEligibilityAndScreening FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '11')) Files), " &
                                     "   TotalNumberOfReviewsWithEligibilityAndScreeningErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '11' AND fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                     "   PercentOfReviewsWithEligibilityAndScreeningErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '11' AND fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                                       ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithEligibilityAndScreeningType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '11')) Files),0),1),3), " &
                                     "" &
                                     "   TotalNumberOfReviewsWithLeasing =                   (SELECT COUNT(*) AS NumberOfReviewsWithLeasing FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '12')) Files), " &
                                     "   TotalNumberOfReviewsWithLeasingErrors =             (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '12' AND fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                     "   PercentOfReviewsWithLeasingErrors =                 ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '12' AND fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                                       ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithLeasingType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '12')) Files),0),1),3), " &
                                     "" &
                                     "   TotalNumberOfReviewsWithDataEntry =                 (SELECT COUNT(*) AS NumberOfReviewsWithDataEntry FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '13')) Files), " &
                                     "   TotalNumberOfReviewsWithDataEntryErrors =           (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '13' AND fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                     "   PercentOfReviewsWithDataEntryErrors =               ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '13' AND fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                                       ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithDataEntryType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '13')) Files),0),1),3), " &
                                     "" &
                                     "   TotalNumberOfReviewsWithOther =                     (SELECT COUNT(*) AS NumberOfReviewsWithOther FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '21')) Files), " &
                                     "   TotalNumberOfReviewsWithOtherErrors =               (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '21' AND fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                     "   PercentOfReviewsWithOtherErrors =                   ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '21' AND fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                                       ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithOtherType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "'  AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '21')) Files),0),1),3), " &
                                     "" &
                                     "   TotalNumberOfReviewsWithSelectionFromTheWaitlist =  (SELECT COUNT(*) AS NumberOfReviewsWithSelectionFromTheWaitlist FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '22')) Files), " &
                                     "   TotalNumberOfReviewsWithSelectionFromTheWaitlistErrors =  (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '22' AND fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                     "   PercentOfReviewsWithSelectionFromTheWaitlistErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '22' AND fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                                       ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithSelectionFromTheWaitlistType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '22')) Files),0),1),3), " &
                                     "" &
                                     "   TotalNumberOfReviewsWithReasonableRent =  (SELECT COUNT(*) AS NumberOfReviewsWithReasonableRent FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                             (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '15')) Files), " &
                                     "   TotalNumberOfReviewsWithReasonableRentErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '15' AND fk_ErrorStaffID = '" & fileStaffID & "'  AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                     "   PercentOfReviewsWithReasonableRentErrors  = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '15' AND fk_ErrorStaffID = '" & fileStaffID & "'  AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                               ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithReasonableRentType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'  AND fk_ReviewTypeID IN " &
                                     "                                               (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '15')) Files),0),1),3), " &
                                     "" &
                                     "   TotalNumberOfReviewsWithPortability = (SELECT COUNT(*) AS NumberOfReviewsWithPortability FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                         (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '16')) Files), " &
                                     "   TotalNumberOfReviewsWithPortabilityErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '16' AND fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                     "   PercentOfReviewsWithPortabilityErrors  = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '16' AND fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                            ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithPortabilityType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                     "                                            (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '16')) Files),0),1),3), " &
                                     "" &
                                     "   TotalNumberOfReviewsWithLotteryNumber = (SELECT COUNT(FileID) FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_AudtitorID = '" & auditorID & "' AND fk_ReviewTypeID = '7' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                     "   TotalNumberOfReviewsWithLotteryNumberErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM LotteryNumberErrors INNER JOIN Files ON LotteryNumberErrors.fk_FileID = Files.FileID WHERE Files.fk_CaseManagerID = '" & fileStaffID & "'  AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                     "   PercentOfReviewsWithLotteryNumberErrors = ROUND((((SELECT COUNT(DISTINCT(fk_FileID)) FROM LotteryNumberErrors INNER JOIN Files ON LotteryNumberErrors.fk_FileID = Files.FileID  WHERE Files.fk_CaseManagerID = '" & fileStaffID & "'  AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                             ISNULL(NULLIF((SELECT COUNT(FileID) FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND  fk_ReviewTypeID = '7' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'),0),1)), 3), " &
                                     "" &
                                     "   TotalNumberOfReviewsWithPortIn = (SELECT COUNT(FileID) FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID = '7' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                     "   TotalNumberOfReviewsWithPortInErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM SpecialCaseErrors INNER JOIN Files ON SpecialCaseErrors.fk_FileID = Files.FileID WHERE Files.fk_CaseManagerID = '" & fileStaffID & "' AND fk_ErrorTypeID = '20' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                     "   PercentOfReviewsWithPortInErrors = ROUND((((SELECT COUNT(DISTINCT(fk_FileID)) FROM SpecialCaseErrors INNER JOIN Files ON SpecialCaseErrors.fk_FileID = Files.FileID WHERE Files.fk_CaseManagerID = '" & fileStaffID & "' AND fk_ErrorTypeID = '20' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                                ISNULL(NULLIF((SELECT COUNT(FileID) FROM Files  WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID = '7' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'),0),1)), 3), " &
                                     "" &
                                     "   TotalNumberOfReviewsWithSpecialAdmission = (SELECT COUNT(FileID) FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID = '7' AND fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                     "   TotalNumberOfReviewsWithSpecialAdmissionErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM SpecialCaseErrors INNER JOIN Files ON SpecialCaseErrors.fk_FileID = Files.FileID WHERE Files.fk_CaseManagerID = '" & fileStaffID & "' AND fk_ErrorTypeID = '19' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                     "   PercentOfReviewsWithSpecialAdmissionErrors = ROUND((((SELECT COUNT(DISTINCT(fk_FileID)) FROM SpecialCaseErrors INNER JOIN Files ON SpecialCaseErrors.fk_FileID = Files.FileID WHERE Files.fk_CaseManagerID = '" & fileStaffID & "' AND fk_ErrorTypeID = '19' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                                ISNULL(NULLIF((SELECT COUNT(FileID) FROM Files  WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID = '7' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'),0),1)), 3), " &
                                     "" &
                                     "   TotalNumberOfReviewsWithDocumentErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '18' AND fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                     "   PercentOfReviewsWithDocumentErrors = ROUND((((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '18' AND fk_ErrorStaffID = '" & fileStaffID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                     "                                        ISNULL(NULLIF((SELECT COUNT(FileID) FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "'  AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'),0),1)), 3) " &
                                     "" &
                                       "FROM Files   " &
                                       "WHERE FileID != '0' AND fk_CaseManagerID = '" & fileStaffID & "'"

                ElseIf (auditorID > 0) Then
                    sql = "SELECT COUNT(FileID) AS TotalReviews, " &
                                    "   TotalReviewsWithErrors = (SELECT COUNT(DISTINCT(fk_FileID))  " &
                                    "                             FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                    "   TotalReviewsWithErrorsPercent = ROUND((((SELECT COUNT(DISTINCT(fk_FileID)) " &
                                    "                                   FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                    "                                   ISNULL(NULLIF((SELECT COUNT(FileID) FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'),0),1)), 3), " &
                                    "   TotalReviewsWithNoErrors = ((SELECT COUNT(FileID) FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') - " &
                                    "                               (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')), " &
                                    "   TotalReviewsWithNoErrorsPercent = ROUND(((((SELECT COUNT(FileID) FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') - " &
                                    "                                     (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'))  * 100.0) / " &
                                    "                                     ISNULL(NULLIF((SELECT COUNT(FileID) FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'),0),1)), 3),  " &
                                    "   TotalNumberOfPendingErrors = ((SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE Status = 'Pending' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')), " &
                                    "   TotalNumberOfCompleteErrors = ((SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE Status = 'Complete' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')), " &
                                    "   TotalNumberOfAllErrors = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                    "" &
                                    "    TotalNumberOfNoticeTypeError = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '1' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                    "    TotalNumberOfNoticeTypeWarning = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '2' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                    "    TotalNumberOfNoticeTypeMissing = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '3' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                    "    TotalNumberOfNoticeTypeNoError = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '4' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                    "    TotalNumberOfNoticeTypeOther = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '5' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                    "    TotalNumberOfNoticeTypeIncome = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '6' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                    "    TotalNumberOfNoticeTypeAdjustedIncome = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '7' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                    "    TotalNumberOfNoticeTypePaymentStandard = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '8' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                    "    TotalNumberOfNoticeTypeUtilityAllowance = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '9' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                    "    TotalNumberOfNoticeTypeContractRent = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '10' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                    "    TotalNumberOfNoticeTypeIncomeOrAdjustedRent = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '11' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                    "" &
                                    "   TotalNumberOfReviewsWithVerification = (SELECT COUNT(*) AS NumberOfReviewsWithVerificationType FROM " &
                                    "                                          (SELECT FileID FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                    "                                          (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '1')) Files),  " &
                                    "   TotalNumberOfReviewsWithVerificationErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '1' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                    "	PercentOfReviewsWithVerificationErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '1' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                    "                                            ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithVerificationType FROM (SELECT FileID FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                    "                                            (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '1')) Files),0),1),3), " &
                                    "" &
                                    "   TotalNumberOfReviewsWithCalculation = (SELECT COUNT(*) AS NumberOfReviewsWithCalculationType FROM (SELECT FileID FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                    "                                         (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '2')) Files)," &
                                    "   TotalNumberOfReviewsWithCalculationErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '2' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                    "   PercentOfReviewsWithCalculationErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '2' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                    "                                           ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithCalculationType FROM (SELECT FileID FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                    "                                           (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '2')) Files),0),1),3), " &
                                    "" &
                                    "   TotalNumberOfReviewsWithPaymentStandard = (SELECT COUNT(*) AS NumberOfReviewsWithPaymentStandardType FROM (SELECT FileID FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                    "                                             (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '3')) Files), " &
                                    "   TotalNumberOfReviewsWithPaymentStandardErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '3' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_Auditor_SubmittedID = '" & auditorID & "')," &
                                    "	PercentOfReviewsWithPaymentStandardErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '3' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_Auditor_SubmittedID = '" & auditorID & "') * 100.0) / " &
                                    "                                               ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithPaymentStandardType FROM (SELECT FileID FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                    "                                               (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '3')) Files),0),1),3), " &
                                    "" &
                                    "   TotalNumberOfReviewsWithUtilityAllowance = (SELECT COUNT(*) AS NumberOfReviewsWithUtilityAllowance FROM (SELECT FileID FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                    "                                              (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '4')) Files), " &
                                    "   TotalNumberOfReviewsWithUtilityAllowanceErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '4' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                    "   PercentOfReviewsWithUtilityAllowanceErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '4' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                    "                                                ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithUtilityAllowanceType FROM (SELECT FileID FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                    "                                               (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '4')) Files),0),1),3), " &
                                    "" &
                                    "	TotalNumberOfReviewsWithTenantRent = (SELECT COUNT(*) AS NumberOfReviewsWithTenantRent FROM	(SELECT FileID FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                    "                                        (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '5')) Files), " &
                                    "   TotalNumberOfReviewsWithTenantRentErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '5' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                    "   PercentOfReviewsWithTenantRentErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '5' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                    "                                          ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithTenantRentType FROM (SELECT FileID FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                    "                                          (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '5')) Files),0),1),3), " &
                                    "" &
                                    "   TotalNumberOfReviewsWithOccupanyStandard = (SELECT COUNT(*) AS NumberOfReviewsWithOccupanyStandard FROM (SELECT FileID FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                    "                                              (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '6')) Files),  " &
                                    "   TotalNumberOfReviewsWithOccupanyStandardErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '6' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                    "   PercentOfReviewsWithOccupanyStandardErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '6' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                    "                                                ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithOccupanyStandardType FROM (SELECT FileID FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                    "                                                (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '6')) Files),0),1),3), " &
                                    "" &
                                    "   TotalNumberOfReviewsWithAnnualReexamination = (SELECT COUNT(*) AS NumberOfReviewsWithAnnualReexamination FROM (SELECT FileID FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                    "                                                (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '7')) Files), " &
                                    "   TotalNumberOfReviewsWithAnnualReexaminationErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '7' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                    "   PercentOfReviewsWithAnnualReexaminationErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '7' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                    "                                                   ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithAnnualReexaminationType FROM (SELECT FileID FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                    "                                                   (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '7')) Files),0),1),3)," &
                                    "" &
                                    "   TotalNumberOfReviewsWithInterimReexamination = (SELECT COUNT(*) AS NumberOfReviewsWithInterimReexamination FROM (SELECT FileID FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                    "                                                 (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '8')) Files)," &
                                    "   TotalNumberOfReviewsWithInterimReexaminationErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '8' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                    "   PercentOfReviewsWithInterimReexaminationErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID	WHERE fk_ProcessTypeID = '8' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                    "                                                    ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithInterimReexaminationType FROM (SELECT FileID FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                    "                                                    (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '8')) Files),0),1),3)," &
                                    "" &
                                    "   TotalNumberOfReviewsWithMoves = (SELECT COUNT(*) AS NumberOfReviewsWithMoves FROM (SELECT FileID FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                    "                                   (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '9')) Files)," &
                                    "   TotalNumberOfReviewsWithMovesErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '9' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                    "   PercentOfReviewsWithMovesErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '9'  AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                    "                                     ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithMovesType FROM (SELECT FileID FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                    "                                     (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '9')) Files),0),1),3), " &
                                    "" &
                                    "   TotalNumberOfReviewsWithChangeInFamilyComposition = (SELECT COUNT(*) AS NumberOfReviewsWithChangeInFamilyComposition FROM (SELECT FileID FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                    "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '10')) Files), " &
                                    "   TotalNumberOfReviewsWithChangeInFamilyCompositionErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '10' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                    "   PercentOfReviewsWithChangeInFamilyCompositionErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '10' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                    "                                                         ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithChangeInFamilyCompositionType FROM (SELECT FileID FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                    "                                                         (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '10')) Files),0),1),3), " &
                                    "" &
                                    "   TotalNumberOfReviewsWithEligibilityAndScreening = (SELECT COUNT(*) AS NumberOfReviewsWithEligibilityAndScreening FROM (SELECT FileID FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                    "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '11')) Files), " &
                                    "   TotalNumberOfReviewsWithEligibilityAndScreeningErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '11' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                    "   PercentOfReviewsWithEligibilityAndScreeningErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '11' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                    "                                                       ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithEligibilityAndScreeningType FROM (SELECT FileID FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                    "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '11')) Files),0),1),3), " &
                                    "" &
                                    "   TotalNumberOfReviewsWithLeasing =                   (SELECT COUNT(*) AS NumberOfReviewsWithLeasing FROM (SELECT FileID FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                    "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '12')) Files), " &
                                    "   TotalNumberOfReviewsWithLeasingErrors =             (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '12' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                    "   PercentOfReviewsWithLeasingErrors =                 ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '12' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                    "                                                       ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithLeasingType FROM (SELECT FileID FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                    "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '12')) Files),0),1),3), " &
                                    "" &
                                    "   TotalNumberOfReviewsWithDataEntry =                 (SELECT COUNT(*) AS NumberOfReviewsWithDataEntry FROM (SELECT FileID FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                    "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '13')) Files), " &
                                    "   TotalNumberOfReviewsWithDataEntryErrors =           (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '13' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                    "   PercentOfReviewsWithDataEntryErrors =               ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '13' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                    "                                                       ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithDataEntryType FROM (SELECT FileID FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                    "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '13')) Files),0),1),3), " &
                                    "" &
                                    "   TotalNumberOfReviewsWithOther =                     (SELECT COUNT(*) AS NumberOfReviewsWithOther FROM (SELECT FileID FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                    "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '21')) Files), " &
                                    "   TotalNumberOfReviewsWithOtherErrors =               (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '21' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                    "   PercentOfReviewsWithOtherErrors =                   ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '21' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                    "                                                       ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithOtherType FROM (SELECT FileID FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                    "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '21')) Files),0),1),3), " &
                                    "" &
                                    "   TotalNumberOfReviewsWithSelectionFromTheWaitlist =  (SELECT COUNT(*) AS NumberOfReviewsWithSelectionFromTheWaitlist FROM (SELECT FileID FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                    "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '22')) Files), " &
                                    "   TotalNumberOfReviewsWithSelectionFromTheWaitlistErrors =  (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '22' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                    "   PercentOfReviewsWithSelectionFromTheWaitlistErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '22' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                    "                                                       ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithSelectionFromTheWaitlistType FROM (SELECT FileID FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                    "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '22')) Files),0),1),3), " &
                                    "" &
                                    "   TotalNumberOfReviewsWithReasonableRent =  (SELECT COUNT(*) AS NumberOfReviewsWithReasonableRent FROM (SELECT FileID FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                    "                                             (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '15')) Files), " &
                                    "   TotalNumberOfReviewsWithReasonableRentErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '15' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                    "   PercentOfReviewsWithReasonableRentErrors  = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '15' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                    "                                               ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithReasonableRentType FROM (SELECT FileID FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'  AND fk_ReviewTypeID IN " &
                                    "                                               (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '15')) Files),0),1),3), " &
                                    "" &
                                    "   TotalNumberOfReviewsWithPortability = (SELECT COUNT(*) AS NumberOfReviewsWithPortability FROM (SELECT FileID FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                    "                                         (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '16')) Files), " &
                                    "   TotalNumberOfReviewsWithPortabilityErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '16' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                    "   PercentOfReviewsWithPortabilityErrors  = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '16' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                    "                                            ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithPortabilityType FROM (SELECT FileID FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                    "                                            (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '16')) Files),0),1),3), " &
                                    "" &
                                    "   TotalNumberOfReviewsWithLotteryNumber = (SELECT COUNT(FileID) FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND fk_ReviewTypeID = '7' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                    "   TotalNumberOfReviewsWithLotteryNumberErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM LotteryNumberErrors INNER JOIN Files ON LotteryNumberErrors.fk_FileID = Files.FileID WHERE LotteryNumberErrors.fk_AuditorID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                    "   PercentOfReviewsWithLotteryNumberErrors = ROUND((((SELECT COUNT(DISTINCT(fk_FileID)) FROM LotteryNumberErrors INNER JOIN Files ON LotteryNumberErrors.fk_FileID = Files.FileID  WHERE LotteryNumberErrors.fk_AuditorID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                    "                                             ISNULL(NULLIF((SELECT COUNT(FileID) FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND  fk_ReviewTypeID = '7' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'),0),1)), 3), " &
                                    "" &
                                    "   TotalNumberOfReviewsWithPortIn = (SELECT COUNT(FileID) FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND fk_ReviewTypeID = '7' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                    "   TotalNumberOfReviewsWithPortInErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM SpecialCaseErrors INNER JOIN Files ON SpecialCaseErrors.fk_FileID = Files.FileID WHERE fk_ErrorTypeID = '20' AND fk_AuditorID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                    "   PercentOfReviewsWithPortInErrors = ROUND((((SELECT COUNT(DISTINCT(fk_FileID)) FROM SpecialCaseErrors INNER JOIN Files ON SpecialCaseErrors.fk_FileID = Files.FileID WHERE fk_ErrorTypeID = '20' AND fk_AuditorID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                    "                                                ISNULL(NULLIF((SELECT COUNT(FileID) FROM Files WHERE fk_ReviewTypeID = '7' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'),0),1)), 3), " &
                                    "" &
                                    "   TotalNumberOfReviewsWithSpecialAdmission = (SELECT COUNT(FileID) FROM Files WHERE fk_ReviewTypeID = '7' AND fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                    "   TotalNumberOfReviewsWithSpecialAdmissionErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM SpecialCaseErrors INNER JOIN Files ON SpecialCaseErrors.fk_FileID = Files.FileID WHERE fk_ErrorTypeID = '19' AND fk_AuditorID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                    "   PercentOfReviewsWithSpecialAdmissionErrors = ROUND((((SELECT COUNT(DISTINCT(fk_FileID)) FROM SpecialCaseErrors INNER JOIN Files ON SpecialCaseErrors.fk_FileID = Files.FileID WHERE fk_ErrorTypeID = '19' AND fk_AuditorID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                    "                                                ISNULL(NULLIF((SELECT COUNT(FileID) FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND fk_ReviewTypeID = '7' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'),0),1)), 3), " &
                                    "" &
                                    "   TotalNumberOfReviewsWithDocumentErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '18' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                    "   PercentOfReviewsWithDocumentErrors = ROUND((((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '18' AND fk_Auditor_SubmittedID = '" & auditorID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                    "                                        ISNULL(NULLIF((SELECT COUNT(FileID) FROM Files WHERE fk_AudtitorID = '" & auditorID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'),0),1)), 3) " &
                                    "" &
                                    "FROM Files   " &
                                    "WHERE FileID != '0' AND fk_AudtitorID = '" & auditorID & "'"

                ElseIf (groupID > 0) Then
                    sql = "SELECT COUNT(FileID) AS TotalReviews, " &
                                      "   TotalReviewsWithErrors = (SELECT COUNT(DISTINCT(fk_FileID))  " &
                                      "                             FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                      "   TotalReviewsWithErrorsPercent = ROUND((((SELECT COUNT(DISTINCT(fk_FileID)) " &
                                      "                                   FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                      "                                   ISNULL(NULLIF((SELECT COUNT(FileID) FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'),0),1)), 3), " &
                                      "   TotalReviewsWithNoErrors = ((SELECT COUNT(FileID) FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') - " &
                                      "                               (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')), " &
                                      "   TotalReviewsWithNoErrorsPercent = ROUND(((((SELECT COUNT(FileID) FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') - " &
                                      "                                     (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'))  * 100.0) / " &
                                      "                                     ISNULL(NULLIF((SELECT COUNT(FileID) FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'),0),1)), 3),  " &
                                      "   TotalNumberOfPendingErrors = ((SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE Groups.GroupID = '" & groupID & "' AND Status = 'Pending' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')), " &
                                      "   TotalNumberOfCompleteErrors = ((SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE Groups.GroupID = '" & groupID & "' AND Status = 'Complete' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')), " &
                                      "   TotalNumberOfAllErrors = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                      "" &
                                       "    TotalNumberOfNoticeTypeError = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '1' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                       "    TotalNumberOfNoticeTypeWarning = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '2' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                       "    TotalNumberOfNoticeTypeMissing = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '3' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                       "    TotalNumberOfNoticeTypeNoError = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '4' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                       "    TotalNumberOfNoticeTypeOther = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '5' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                       "    TotalNumberOfNoticeTypeIncome = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '6' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                       "    TotalNumberOfNoticeTypeAdjustedIncome = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '7' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                       "    TotalNumberOfNoticeTypePaymentStandard = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '8' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                       "    TotalNumberOfNoticeTypeUtilityAllowance = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '9' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                       "    TotalNumberOfNoticeTypeContractRent = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '10' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                       "    TotalNumberOfNoticeTypeIncomeOrAdjustedRent = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '11' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                       "" &
                                      "   TotalNumberOfReviewsWithVerification = (SELECT COUNT(*) AS NumberOfReviewsWithVerificationType FROM " &
                                      "                                          (SELECT FileID FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                      "                                          (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '1')) Files),  " &
                                      "   TotalNumberOfReviewsWithVerificationErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '1' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                      "	  PercentOfReviewsWithVerificationErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '1' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                      "                                            ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithVerificationType FROM (SELECT FileID FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                      "                                            (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '1')) Files),0),1),3), " &
                                       "" &
                                        "   TotalNumberOfReviewsWithCalculation = (SELECT COUNT(*) AS NumberOfReviewsWithCalculationType FROM (SELECT FileID FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                         "                                         (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '2')) Files)," &
                                        "   TotalNumberOfReviewsWithCalculationErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE Groups.GroupID = '" & groupID & "' AND fk_ProcessTypeID = '2' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                        "   PercentOfReviewsWithCalculationErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE Groups.GroupID = '" & groupID & "' AND fk_ProcessTypeID = '2' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                        "                                            ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                        "                                            (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '2')) Files),0),1),3), " &
                                        "" &
                                        "   TotalNumberOfReviewsWithPaymentStandard = (SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                         "                                             (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '3')) Files)," &
                                         "   TotalNumberOfReviewsWithPaymentStandardErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '3' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                        "	PercentOfReviewsWithPaymentStandardErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '3' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                         "                                            ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                        "                                            (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '3')) Files),0),1),3), " &
                                        "" &
                                         "   TotalNumberOfReviewsWithUtilityAllowance = (SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                        "                                             (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '4')) Files)," &
                                        "   TotalNumberOfReviewsWithUtilityAllowanceErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '4' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                        "   PercentOfReviewsWithUtilityAllowanceErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '4' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                        "                                            ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                        "                                            (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '4')) Files),0),1),3), " &
                                        "" &
                                        "	TotalNumberOfReviewsWithTenantRent = (SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                        "                                             (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '5')) Files)," &
                                        "   TotalNumberOfReviewsWithTenantRentErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '5'  AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                        "   PercentOfReviewsWithTenantRentErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '5' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                        "                                           ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                        "                                          (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '5')) Files),0),1),3), " &
                                        "" &
                                        "   TotalNumberOfReviewsWithOccupanyStandard = (SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                        "                                             (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '6')) Files)," &
                                        "   TotalNumberOfReviewsWithOccupanyStandardErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '6' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                        "   PercentOfReviewsWithOccupanyStandardErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '6' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                        "                                                ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                        "                                                (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '6')) Files),0),1),3), " &
                                        "" &
                                        "   TotalNumberOfReviewsWithAnnualReexamination = (SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                        "                                                 (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '7')) Files)," &
                                        "   TotalNumberOfReviewsWithAnnualReexaminationErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '7' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                        "   PercentOfReviewsWithAnnualReexaminationErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '7' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                        "                                                ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                        "                                                (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '7')) Files),0),1),3), " &
                                        "" &
                                        "   TotalNumberOfReviewsWithInterimReexamination = (SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                        "                                                 (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '8')) Files)," &
                                        "   TotalNumberOfReviewsWithInterimReexaminationErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '8' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                        "   PercentOfReviewsWithInterimReexaminationErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '8' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                        "                                                    ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                        "                                                    (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '8')) Files),0),1),3), " &
                                        "" &
                                        "   TotalNumberOfReviewsWithMoves = (SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                        "                                   (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '9')) Files)," &
                                        "   TotalNumberOfReviewsWithMovesErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '9' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                        "   PercentOfReviewsWithMovesErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '9' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                        "                                     ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                        "                                     (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '9')) Files),0),1),3), " &
                                        "" &
                                        "   TotalNumberOfReviewsWithChangeInFamilyComposition = (SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                        "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '10')) Files)," &
                                        "   TotalNumberOfReviewsWithChangeInFamilyCompositionErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '10' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                        "   PercentOfReviewsWithChangeInFamilyCompositionErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '10' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                        "                                                        ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID  WHERE Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                        "                                                        (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '10')) Files),0),1),3), " &
                                        "   TotalNumberOfReviewsWithEligibilityAndScreening = (SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                        "                                                     (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '11')) Files)," &
                                        "   TotalNumberOfReviewsWithEligibilityAndScreeningErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '11' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                        "   PercentOfReviewsWithEligibilityAndScreeningErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '11' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                        "                                                        ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                        "                                                        (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '11')) Files),0),1),3), " &
                                        "" &
                                        "   TotalNumberOfReviewsWithLeasing =                   (SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                        "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '12')) Files)," &
                                        "   TotalNumberOfReviewsWithLeasingErrors =             (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '12' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                        "   PercentOfReviewsWithLeasingErrors =                  ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '12' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                        "                                                        ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                        "                                                        (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '12')) Files),0),1),3), " &
                                        "" &
                                        "   TotalNumberOfReviewsWithDataEntry =                (SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                        "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '13')) Files)," &
                                        "   TotalNumberOfReviewsWithDataEntryErrors =           (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '13' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                        "   PercentOfReviewsWithDataEntryErrors =               ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '13' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                        "                                                        ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                        "                                                        (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '13')) Files),0),1),3), " &
                                        "" &
                                        "   TotalNumberOfReviewsWithOther =                      (SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                        "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '21')) Files)," &
                                        "   TotalNumberOfReviewsWithOtherErrors =              (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '21' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                        "   PercentOfReviewsWithOtherErrors =                  ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '21' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                        "                                                        ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                        "                                                        (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '21')) Files),0),1),3), " &
                                        "" &
                                        "   TotalNumberOfReviewsWithSelectionFromTheWaitlist =  (SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                        "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '22')) Files)," &
                                        "   TotalNumberOfReviewsWithSelectionFromTheWaitlistErrors =  (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '22' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                        "   PercentOfReviewsWithSelectionFromTheWaitlistErrors =  ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '22' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                        "                                                        ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                        "                                                        (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '22')) Files),0),1),3), " &
                                        "" &
                                        "   TotalNumberOfReviewsWithReasonableRent = (SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                        "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '15')) Files)," &
                                        "   TotalNumberOfReviewsWithReasonableRentErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '15' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                        "   PercentOfReviewsWithReasonableRentErrors  =  ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '15' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                        "                                                 ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                        "                                                  (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '15')) Files),0),1),3), " &
                                        "" &
                                        "   TotalNumberOfReviewsWithPortability = (SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                        "                                         (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '16')) Files)," &
                                        "   TotalNumberOfReviewsWithPortabilityErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '16' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                        "   PercentOfReviewsWithPortabilityErrors  = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '16' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                        "                                             ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                        "                                              (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '16')) Files),0),1),3), " &
                                        "" &
                                        "   TotalNumberOfReviewsWithLotteryNumber = (SELECT COUNT(FileID) FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE fk_ReviewTypeID = '7' AND Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                        "   TotalNumberOfReviewsWithLotteryNumberErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM LotteryNumberErrors INNER JOIN Files ON LotteryNumberErrors.fk_FileID = Files.FileID INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                        "   PercentOfReviewsWithLotteryNumberErrors = ROUND((((SELECT COUNT(DISTINCT(fk_FileID)) FROM LotteryNumberErrors INNER JOIN Files ON LotteryNumberErrors.fk_FileID = Files.FileID INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                        "                                             ISNULL(NULLIF((SELECT COUNT(FileID) FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE fk_ReviewTypeID = '7' AND Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'),0),1)), 3), " &
                                        "" &
                                        "   TotalNumberOfReviewsWithPortIn = (SELECT COUNT(FileID) FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE fk_ReviewTypeID = '7' AND Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                        "   TotalNumberOfReviewsWithPortInErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM SpecialCaseErrors INNER JOIN Files ON SpecialCaseErrors.fk_FileID = Files.FileID INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID  WHERE fk_ErrorTypeID = '20' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                        "   PercentOfReviewsWithPortInErrors = ROUND((((SELECT COUNT(DISTINCT(fk_FileID)) FROM SpecialCaseErrors INNER JOIN Files ON SpecialCaseErrors.fk_FileID = Files.FileID INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID  WHERE fk_ErrorTypeID = '20' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                        "                                                ISNULL(NULLIF((SELECT COUNT(FileID) FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE fk_ReviewTypeID = '7' AND Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'),0),1)), 3), " &
                                        "" &
                                        "   TotalNumberOfReviewsWithSpecialAdmission = (SELECT COUNT(FileID) FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE fk_ReviewTypeID = '7' AND Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                        "   TotalNumberOfReviewsWithSpecialAdmissionErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM SpecialCaseErrors INNER JOIN Files ON SpecialCaseErrors.fk_FileID = Files.FileID INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE fk_ErrorTypeID = '19' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                        "   PercentOfReviewsWithSpecialAdmissionErrors = ROUND((((SELECT COUNT(DISTINCT(fk_FileID)) FROM SpecialCaseErrors INNER JOIN Files ON SpecialCaseErrors.fk_FileID = Files.FileID INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE fk_ErrorTypeID = '19' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                        "                                                ISNULL(NULLIF((SELECT COUNT(FileID) FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE fk_ReviewTypeID = '7' AND Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'),0),1)), 3), " &
                                        "" &
                                        "   TotalNumberOfReviewsWithDocumentErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '18' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                        "   PercentOfReviewsWithDocumentErrors = ROUND((((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Users ON FileErrors.fk_ErrorStaffID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '18' AND Groups.GroupID = '" & groupID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                        "                                        ISNULL(NULLIF((SELECT COUNT(FileID) FROM Files INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID WHERE Groups.GroupID = '" & groupID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'),0),1)), 3) " &
                                        "" &
                                      "FROM Files   " &
                                      "INNER JOIN Users ON Files.fk_CaseManagerID = Users.UserID " &
                                      "INNER JOIN Groups ON Users.fk_GroupID = Groups.GroupID " &
                                      "WHERE FileID != '0' AND Groups.GroupID = '" & groupID & "' "

                Else
                    sql = "SELECT COUNT(FileID) AS TotalReviews, " &
                                       "   TotalReviewsWithErrors = (SELECT COUNT(DISTINCT(fk_FileID))  " &
                                       "                             FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                       "   TotalReviewsWithErrorsPercent = ROUND((((SELECT COUNT(DISTINCT(fk_FileID)) " &
                                       "                                   FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                       "                                   ISNULL(NULLIF((SELECT COUNT(FileID) FROM Files WHERE ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'),0),1)), 3), " &
                                       "   TotalReviewsWithNoErrors = ((SELECT COUNT(FileID) FROM Files WHERE ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') - " &
                                       "                               (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')), " &
                                       "   TotalReviewsWithNoErrorsPercent = ROUND(((((SELECT COUNT(FileID) FROM Files WHERE ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') - " &
                                       "                                     (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'))  * 100.0) / " &
                                       "                                     ISNULL(NULLIF((SELECT COUNT(FileID) FROM Files WHERE ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'),0),1)), 3),  " &
                                       "   TotalNumberOfPendingErrors = ((SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE Status = 'Pending' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')), " &
                                       "   TotalNumberOfCompleteErrors = ((SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE Status = 'Complete' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')), " &
                                       "   TotalNumberOfAllErrors = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                       "" &
                                       "    TotalNumberOfNoticeTypeError = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '1' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                       "    TotalNumberOfNoticeTypeWarning = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '2' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                       "    TotalNumberOfNoticeTypeMissing = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '3' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                       "    TotalNumberOfNoticeTypeNoError = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '4' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                       "    TotalNumberOfNoticeTypeOther = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '5' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                       "    TotalNumberOfNoticeTypeIncome = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '6' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                       "    TotalNumberOfNoticeTypeAdjustedIncome = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '7' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                       "    TotalNumberOfNoticeTypePaymentStandard = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '8' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                       "    TotalNumberOfNoticeTypeUtilityAllowance = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '9' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                       "    TotalNumberOfNoticeTypeContractRent = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '10' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                       "    TotalNumberOfNoticeTypeIncomeOrAdjustedRent = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '11' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                       "" &
                                       "   TotalNumberOfReviewsWithVerification = (SELECT COUNT(*) AS NumberOfReviewsWithVerificationType FROM " &
                                       "                                          (SELECT FileID FROM Files WHERE ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                       "                                          (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '1')) Files),  " &
                                       "   TotalNumberOfReviewsWithVerificationErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '1' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                       "	PercentOfReviewsWithVerificationErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '1' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                       "                                            ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithVerificationType FROM (SELECT FileID FROM Files WHERE ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                       "                                            (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '1')) Files),0),1),3), " &
                                       "" &
                                       "   TotalNumberOfReviewsWithCalculation = (SELECT COUNT(*) AS NumberOfReviewsWithCalculationType FROM (SELECT FileID FROM Files WHERE ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                       "                                         (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '2')) Files)," &
                                       "   TotalNumberOfReviewsWithCalculationErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '2' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                       "   PercentOfReviewsWithCalculationErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '2' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                       "                                            ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                       "                                            (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '2')) Files),0),1),3), " &
                                       "" &
                                       "   TotalNumberOfReviewsWithPaymentStandard = (SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                       "                                             (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '3')) Files)," &
                                       "   TotalNumberOfReviewsWithPaymentStandardErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '3' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                       "	PercentOfReviewsWithPaymentStandardErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '3' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                       "                                            ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                       "                                            (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '3')) Files),0),1),3), " &
                                       "" &
                                       "   TotalNumberOfReviewsWithUtilityAllowance = (SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                       "                                             (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '4')) Files)," &
                                       "   TotalNumberOfReviewsWithUtilityAllowanceErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '4' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                       "   PercentOfReviewsWithUtilityAllowanceErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '4' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                       "                                            ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                       "                                            (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '4')) Files),0),1),3), " &
                                       "" &
                                       "	TotalNumberOfReviewsWithTenantRent = (SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                       "                                             (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '5')) Files)," &
                                       "   TotalNumberOfReviewsWithTenantRentErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '5' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                       "   PercentOfReviewsWithTenantRentErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '5' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                       "                                           ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                       "                                          (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '5')) Files),0),1),3), " &
                                       "" &
                                       "   TotalNumberOfReviewsWithOccupanyStandard = (SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                       "                                             (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '6')) Files)," &
                                       "   TotalNumberOfReviewsWithOccupanyStandardErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '6' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                       "   PercentOfReviewsWithOccupanyStandardErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '6' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                       "                                                ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                       "                                                (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '6')) Files),0),1),3), " &
                                       "" &
                                       "   TotalNumberOfReviewsWithAnnualReexamination = (SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                       "                                                 (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '7')) Files)," &
                                       "   TotalNumberOfReviewsWithAnnualReexaminationErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '7' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                       "   PercentOfReviewsWithAnnualReexaminationErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '7' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                       "                                                ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                       "                                                (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '7')) Files),0),1),3), " &
                                       "" &
                                       "   TotalNumberOfReviewsWithInterimReexamination = (SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                       "                                                 (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '8')) Files)," &
                                       "   TotalNumberOfReviewsWithInterimReexaminationErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '8' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                       "   PercentOfReviewsWithInterimReexaminationErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '8' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                       "                                                    ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                       "                                                    (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '8')) Files),0),1),3), " &
                                       "" &
                                       "   TotalNumberOfReviewsWithMoves = (SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                       "                                   (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '9')) Files)," &
                                       "   TotalNumberOfReviewsWithMovesErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '9' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                       "   PercentOfReviewsWithMovesErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '9' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                       "                                     ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                       "                                     (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '9')) Files),0),1),3), " &
                                       "" &
                                       "   TotalNumberOfReviewsWithChangeInFamilyComposition = (SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                       "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '10')) Files)," &
                                       "   TotalNumberOfReviewsWithChangeInFamilyCompositionErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '10' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                       "   PercentOfReviewsWithChangeInFamilyCompositionErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '10' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                       "                                                        ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                       "                                                        (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '10')) Files),0),1),3), " &
                                       "" &
                                       "   TotalNumberOfReviewsWithEligibilityAndScreening = (SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                       "                                                     (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '11')) Files)," &
                                       "   TotalNumberOfReviewsWithEligibilityAndScreeningErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '11' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                       "   PercentOfReviewsWithEligibilityAndScreeningErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '11' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                       "                                                        ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                       "                                                        (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '11')) Files),0),1),3), " &
                                       "" &
                                       "   TotalNumberOfReviewsWithLeasing =                   (SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                       "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '12')) Files)," &
                                       "   TotalNumberOfReviewsWithLeasingErrors =             (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '12' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                       "   PercentOfReviewsWithLeasingErrors =                  ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '12' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                       "                                                        ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                       "                                                        (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '12')) Files),0),1),3), " &
                                       "" &
                                       "   TotalNumberOfReviewsWithDataEntry =                (SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                       "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '13')) Files)," &
                                       "   TotalNumberOfReviewsWithDataEntryErrors =           (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '13' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                       "   PercentOfReviewsWithDataEntryErrors =               ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '13' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                       "                                                        ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                       "                                                        (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '13')) Files),0),1),3), " &
                                       "" &
                                       "   TotalNumberOfReviewsWithOther =                      (SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                       "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '21')) Files)," &
                                       "   TotalNumberOfReviewsWithOtherErrors =              (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '21' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                       "   PercentOfReviewsWithOtherErrors =                  ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '21' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                       "                                                        ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                       "                                                        (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '21')) Files),0),1),3), " &
                                       "" &
                                       "   TotalNumberOfReviewsWithSelectionFromTheWaitlist =  (SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                       "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '22')) Files)," &
                                       "   TotalNumberOfReviewsWithSelectionFromTheWaitlistErrors =  (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '22' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                       "   PercentOfReviewsWithSelectionFromTheWaitlistErrors =  ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '22' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                       "                                                        ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                       "                                                        (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '22')) Files),0),1),3), " &
                                       "" &
                                       "   TotalNumberOfReviewsWithReasonableRent = (SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                       "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '15')) Files)," &
                                       "   TotalNumberOfReviewsWithReasonableRentErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '15' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                       "   PercentOfReviewsWithReasonableRentErrors  =  ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '15' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                       "                                                 ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                       "                                                  (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '15')) Files),0),1),3), " &
                                       "" &
                                       "   TotalNumberOfReviewsWithPortability = (SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                       "                                         (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '16')) Files)," &
                                       "   TotalNumberOfReviewsWithPortabilityErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '16' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                       "   PercentOfReviewsWithPortabilityErrors  = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '16' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                       "                                             ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                       "                                              (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '16')) Files),0),1),3), " &
                                       "" &
                                       "   TotalNumberOfReviewsWithLotteryNumber = (SELECT COUNT(FileID) FROM Files WHERE fk_ReviewTypeID = '7' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                       "   TotalNumberOfReviewsWithLotteryNumberErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM LotteryNumberErrors INNER JOIN Files ON LotteryNumberErrors.fk_FileID = Files.FileID WHERE Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                       "   PercentOfReviewsWithLotteryNumberErrors = ROUND((((SELECT COUNT(DISTINCT(fk_FileID)) FROM LotteryNumberErrors INNER JOIN Files ON LotteryNumberErrors.fk_FileID = Files.FileID WHERE Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                       "                                             ISNULL(NULLIF((SELECT COUNT(FileID) FROM Files WHERE fk_ReviewTypeID = '7' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'),0),1)), 3), " &
                                       "" &
                                       "   TotalNumberOfReviewsWithPortIn = (SELECT COUNT(FileID) FROM Files WHERE fk_ReviewTypeID = '7' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                       "   TotalNumberOfReviewsWithPortInErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM SpecialCaseErrors INNER JOIN Files ON SpecialCaseErrors.fk_FileID = Files.FileID WHERE fk_ErrorTypeID = '20' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                       "   PercentOfReviewsWithPortInErrors = ROUND((((SELECT COUNT(DISTINCT(fk_FileID)) FROM SpecialCaseErrors INNER JOIN Files ON SpecialCaseErrors.fk_FileID = Files.FileID WHERE fk_ErrorTypeID = '20' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                       "                                                ISNULL(NULLIF((SELECT COUNT(FileID) FROM Files WHERE fk_ReviewTypeID = '7' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'),0),1)), 3), " &
                                       "" &
                                       "   TotalNumberOfReviewsWithSpecialAdmission = (SELECT COUNT(FileID) FROM Files WHERE fk_ReviewTypeID = '7' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                       "   TotalNumberOfReviewsWithSpecialAdmissionErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM SpecialCaseErrors INNER JOIN Files ON SpecialCaseErrors.fk_FileID = Files.FileID WHERE fk_ErrorTypeID = '19' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                       "   PercentOfReviewsWithSpecialAdmissionErrors = ROUND((((SELECT COUNT(DISTINCT(fk_FileID)) FROM SpecialCaseErrors INNER JOIN Files ON SpecialCaseErrors.fk_FileID = Files.FileID WHERE fk_ErrorTypeID = '19' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                       "                                                ISNULL(NULLIF((SELECT COUNT(FileID) FROM Files WHERE fk_ReviewTypeID = '7' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'),0),1)), 3), " &
                                       "" &
                                       "   TotalNumberOfReviewsWithDocumentErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '18' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                       "   PercentOfReviewsWithDocumentErrors = ROUND((((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '18' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                       "                                        ISNULL(NULLIF((SELECT COUNT(FileID) FROM Files WHERE ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'),0),1)), 3) " &
                                       "" &
                                       "FROM Files   " &
                                       "WHERE FileID != '0' "
                End If

                If Not String.IsNullOrEmpty(reviewDateBeginUnconverted) And Not String.IsNullOrEmpty(reviewDateEndUnconverted) Then
                    sql += " AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' "
                End If

                SqlStatisticalReview.SelectCommand = sql
                SqlStatisticalReview.DataBind()
                Summary.DataBind()
                Composition.DataBind()

            Case HOUSING_SPECALIST
                sql = "SELECT COUNT(FileID) AS TotalReviews, " &
                                      "   TotalReviewsWithErrors = (SELECT COUNT(DISTINCT(fk_FileID))  " &
                                      "                             FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ErrorStaffID = '" & sessionUserID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                      "   TotalReviewsWithErrorsPercent = ROUND((((SELECT COUNT(DISTINCT(fk_FileID)) " &
                                      "                                   FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ErrorStaffID = '" & sessionUserID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                      "                                   ISNULL(NULLIF((SELECT COUNT(FileID) FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'),0),1)), 3), " &
                                      "   TotalReviewsWithNoErrors = ((SELECT COUNT(FileID) FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') - " &
                                      "                               (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ErrorStaffID = '" & sessionUserID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')), " &
                                      "   TotalReviewsWithNoErrorsPercent = ROUND(((((SELECT COUNT(FileID) FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') - " &
                                      "                                     (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ErrorStaffID = '" & sessionUserID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'))  * 100.0) / " &
                                      "                                     ISNULL(NULLIF((SELECT COUNT(FileID) FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'),0),1)), 3),  " &
                                      "   TotalNumberOfPendingErrors = ((SELECT COUNT(fk_FileID) FROM FileErrors  INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE Status = 'Pending' AND fk_ErrorStaffID = '" & sessionUserID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')), " &
                                      "   TotalNumberOfCompleteErrors = ((SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE Status = 'Complete' AND fk_ErrorStaffID = '" & sessionUserID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')), " &
                                      "   TotalNumberOfAllErrors = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ErrorStaffID = '" & sessionUserID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                      "" &
                                      "    TotalNumberOfNoticeTypeError = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '1' AND fk_ErrorStaffID = '" & sessionUserID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                      "    TotalNumberOfNoticeTypeWarning = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '2' AND fk_ErrorStaffID = '" & sessionUserID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                      "    TotalNumberOfNoticeTypeMissing = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '3' AND fk_ErrorStaffID = '" & sessionUserID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                      "    TotalNumberOfNoticeTypeNoError = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '4' AND fk_ErrorStaffID = '" & sessionUserID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                      "    TotalNumberOfNoticeTypeOther = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '5' AND fk_ErrorStaffID = '" & sessionUserID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                      "    TotalNumberOfNoticeTypeIncome = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '6' AND fk_ErrorStaffID = '" & sessionUserID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                      "    TotalNumberOfNoticeTypeAdjustedIncome = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '7' AND fk_ErrorStaffID = '" & sessionUserID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                      "    TotalNumberOfNoticeTypePaymentStandard = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '8' AND fk_ErrorStaffID = '" & sessionUserID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                      "    TotalNumberOfNoticeTypeUtilityAllowance = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '9' AND fk_ErrorStaffID = '" & sessionUserID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                      "    TotalNumberOfNoticeTypeContractRent = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '10' AND fk_ErrorStaffID = '" & sessionUserID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                      "    TotalNumberOfNoticeTypeIncomeOrAdjustedRent = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '11' AND fk_ErrorStaffID = '" & sessionUserID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                      "" &
                                      "   TotalNumberOfReviewsWithVerification = (SELECT COUNT(*) AS NumberOfReviewsWithVerificationType FROM " &
                                      "                                          (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                      "                                          (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '1')) Files),  " &
                                      "   TotalNumberOfReviewsWithVerificationErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '1' AND fk_ErrorStaffID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                      "	PercentOfReviewsWithVerificationErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '1' AND fk_ErrorStaffID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                      "                                            ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithVerificationType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                      "                                            (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '1')) Files),0),1),3), " &
                                      "" &
                                      "   TotalNumberOfReviewsWithCalculation = (SELECT COUNT(*) AS NumberOfReviewsWithCalculationType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                      "                                         (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '2')) Files)," &
                                      "   TotalNumberOfReviewsWithCalculationErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '2' AND fk_ErrorStaffID = '" & sessionUserID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                      "   PercentOfReviewsWithCalculationErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '2' AND fk_ErrorStaffID = '" & sessionUserID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                      "                                           ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithCalculationType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                      "                                           (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '2')) Files),0),1),3), " &
                                      "" &
                                      "   TotalNumberOfReviewsWithPaymentStandard = (SELECT COUNT(*) AS NumberOfReviewsWithPaymentStandardType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                      "                                             (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '3')) Files), " &
                                      "   TotalNumberOfReviewsWithPaymentStandardErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '3' AND fk_ErrorStaffID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                      "	PercentOfReviewsWithPaymentStandardErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '3' AND fk_ErrorStaffID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                      "                                               ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithPaymentStandardType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                      "                                               (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '3')) Files),0),1),3), " &
                                      "" &
                                      "   TotalNumberOfReviewsWithUtilityAllowance = (SELECT COUNT(*) AS NumberOfReviewsWithUtilityAllowance FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                      "                                              (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '4')) Files), " &
                                      "   TotalNumberOfReviewsWithUtilityAllowanceErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '4' AND fk_ErrorStaffID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                      "   PercentOfReviewsWithUtilityAllowanceErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '4' AND fk_ErrorStaffID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                      "                                                ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithUtilityAllowanceType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                      "                                               (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '4')) Files),0),1),3), " &
                                      "" &
                                      "	TotalNumberOfReviewsWithTenantRent = (SELECT COUNT(*) AS NumberOfReviewsWithTenantRent FROM	(SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                      "                                        (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '5')) Files), " &
                                      "   TotalNumberOfReviewsWithTenantRentErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '5' AND fk_ErrorStaffID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                      "   PercentOfReviewsWithTenantRentErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '5' AND fk_ErrorStaffID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                      "                                          ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithTenantRentType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                      "                                          (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '5')) Files),0),1),3), " &
                                      "" &
                                      "   TotalNumberOfReviewsWithOccupanyStandard = (SELECT COUNT(*) AS NumberOfReviewsWithOccupanyStandard FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                      "                                              (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '6')) Files),  " &
                                      "   TotalNumberOfReviewsWithOccupanyStandardErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '6' AND fk_ErrorStaffID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                      "   PercentOfReviewsWithOccupanyStandardErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '6' AND fk_ErrorStaffID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                      "                                                ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithOccupanyStandardType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                      "                                                (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '6')) Files),0),1),3), " &
                                      "" &
                                      "   TotalNumberOfReviewsWithAnnualReexamination = (SELECT COUNT(*) AS NumberOfReviewsWithAnnualReexamination FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND  fk_ReviewTypeID IN " &
                                      "                                                (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '7')) Files), " &
                                      "   TotalNumberOfReviewsWithAnnualReexaminationErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '7' AND fk_ErrorStaffID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                      "   PercentOfReviewsWithAnnualReexaminationErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '7' AND fk_ErrorStaffID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                      "                                                   ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithAnnualReexaminationType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                      "                                                   (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '7')) Files),0),1),3)," &
                                      "" &
                                      "   TotalNumberOfReviewsWithInterimReexamination = (SELECT COUNT(*) AS NumberOfReviewsWithInterimReexamination FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                      "                                                 (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '8')) Files)," &
                                      "   TotalNumberOfReviewsWithInterimReexaminationErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '8' AND fk_ErrorStaffID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                      "   PercentOfReviewsWithInterimReexaminationErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '8' AND fk_ErrorStaffID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                      "                                                    ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithInterimReexaminationType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                      "                                                    (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '8')) Files),0),1),3)," &
                                      "" &
                                      "   TotalNumberOfReviewsWithMoves = (SELECT COUNT(*) AS NumberOfReviewsWithMoves FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                      "                                   (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '9')) Files)," &
                                      "   TotalNumberOfReviewsWithMovesErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '9' AND fk_ErrorStaffID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                      "   PercentOfReviewsWithMovesErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '9' AND fk_ErrorStaffID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                      "                                     ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithMovesType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                      "                                     (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '9')) Files),0),1),3), " &
                                      "" &
                                      "   TotalNumberOfReviewsWithChangeInFamilyComposition = (SELECT COUNT(*) AS NumberOfReviewsWithChangeInFamilyComposition FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                      "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '10')) Files), " &
                                      "   TotalNumberOfReviewsWithChangeInFamilyCompositionErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '10' AND fk_ErrorStaffID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                      "   PercentOfReviewsWithChangeInFamilyCompositionErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '10' AND fk_ErrorStaffID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                      "                                                         ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithChangeInFamilyCompositionType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                      "                                                         (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '10')) Files),0),1),3), " &
                                      "" &
                                      "   TotalNumberOfReviewsWithEligibilityAndScreening = (SELECT COUNT(*) AS NumberOfReviewsWithEligibilityAndScreening FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                      "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '11')) Files), " &
                                      "   TotalNumberOfReviewsWithEligibilityAndScreeningErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '11' AND fk_ErrorStaffID = '" & sessionUserID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                      "   PercentOfReviewsWithEligibilityAndScreeningErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '11' AND fk_ErrorStaffID = '" & sessionUserID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                      "                                                       ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithEligibilityAndScreeningType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                      "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '11')) Files),0),1),3), " &
                                      "" &
                                      "   TotalNumberOfReviewsWithLeasing =                   (SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                      "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '12')) Files), " &
                                      "   TotalNumberOfReviewsWithLeasingErrors =             (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '12' AND fk_ErrorStaffID = '" & sessionUserID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                      "   PercentOfReviewsWithLeasingErrors =                 ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '12' AND fk_ErrorStaffID = '" & sessionUserID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                      "                                                       ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                      "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '12')) Files),0),1),3), " &
                                      "" &
                                      "   TotalNumberOfReviewsWithDataEntry =                 (SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                      "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '13')) Files), " &
                                      "   TotalNumberOfReviewsWithDataEntryErrors =            (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '13' AND fk_ErrorStaffID = '" & sessionUserID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                      "   PercentOfReviewsWithDataEntryErrors =               ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '13' AND fk_ErrorStaffID = '" & sessionUserID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                      "                                                       ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                      "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '13')) Files),0),1),3), " &
                                      "" &
                                      "   TotalNumberOfReviewsWithOther =                     (SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                      "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '21')) Files), " &
                                      "   TotalNumberOfReviewsWithOtherErrors =               (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '21' AND fk_ErrorStaffID = '" & sessionUserID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                      "   PercentOfReviewsWithOtherErrors =                   ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '21' AND fk_ErrorStaffID = '" & sessionUserID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                      "                                                       ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                      "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '21')) Files),0),1),3), " &
                                      "" &
                                      "   TotalNumberOfReviewsWithSelectionFromTheWaitlist =  (SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                      "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '22')) Files), " &
                                      "   TotalNumberOfReviewsWithSelectionFromTheWaitlistErrors =  (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '22' AND fk_ErrorStaffID = '" & sessionUserID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                      "   PercentOfReviewsWithSelectionFromTheWaitlistErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '22' AND fk_ErrorStaffID = '" & sessionUserID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                      "                                                       ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                      "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '22')) Files),0),1),3), " &
                                      "" &
                                      "   TotalNumberOfReviewsWithReasonableRent =  (SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                      "                                             (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '15')) Files), " &
                                      "   TotalNumberOfReviewsWithReasonableRentErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '15' AND fk_ErrorStaffID = '" & sessionUserID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                      "   PercentOfReviewsWithReasonableRentErrors  = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '15' AND fk_ErrorStaffID = '" & sessionUserID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                      "                                               ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                      "                                               (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '15')) Files),0),1),3), " &
                                      "" &
                                      "   TotalNumberOfReviewsWithPortability = (SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                      "                                        (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '16')) Files), " &
                                      "   TotalNumberOfReviewsWithPortabilityErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '16' AND fk_ErrorStaffID = '" & sessionUserID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                      "   PercentOfReviewsWithPortabilityErrors  = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '16' AND fk_ErrorStaffID = '" & sessionUserID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                      "                                             ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviews FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' AND fk_ReviewTypeID IN " &
                                      "                                            (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '16')) Files),0),1),3), " &
                                      "" &
                                      "   TotalNumberOfReviewsWithLotteryNumber = (SELECT COUNT(FileID) FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND fk_ReviewTypeID = '7' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                      "   TotalNumberOfReviewsWithLotteryNumberErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM LotteryNumberErrors INNER JOIN Files ON LotteryNumberErrors.fk_FileID = Files.FileID WHERE Files.fk_CaseManagerID = '" & sessionUserID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                      "   PercentOfReviewsWithLotteryNumberErrors = ROUND((((SELECT COUNT(DISTINCT(fk_FileID)) FROM LotteryNumberErrors INNER JOIN Files ON LotteryNumberErrors.fk_FileID = Files.FileID  WHERE Files.fk_CaseManagerID = '" & sessionUserID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                      "                                             ISNULL(NULLIF((SELECT COUNT(FileID) FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND  fk_ReviewTypeID = '7'),0),1)), 3), " &
                                      "" &
                                      "   TotalNumberOfReviewsWithPortIn = (SELECT COUNT(FileID) FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND fk_ReviewTypeID = '7' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                      "   TotalNumberOfReviewsWithPortInErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM SpecialCaseErrors INNER JOIN Files ON SpecialCaseErrors.fk_FileID = Files.FileID WHERE Files.fk_CaseManagerID = '" & sessionUserID & "' AND fk_ErrorTypeID = '20' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                      "   PercentOfReviewsWithPortInErrors = ROUND((((SELECT COUNT(DISTINCT(fk_FileID)) FROM SpecialCaseErrors INNER JOIN Files ON SpecialCaseErrors.fk_FileID = Files.FileID WHERE Files.fk_CaseManagerID = '" & sessionUserID & "' AND fk_ErrorTypeID = '20' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                      "                                                ISNULL(NULLIF((SELECT COUNT(FileID) FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND fk_ReviewTypeID = '7'),0),1)), 3), " &
                                      "" &
                                      "   TotalNumberOfReviewsWithSpecialAdmission = (SELECT COUNT(FileID) FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND fk_ReviewTypeID = '7' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'), " &
                                      "   TotalNumberOfReviewsWithSpecialAdmissionErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM SpecialCaseErrors INNER JOIN Files ON SpecialCaseErrors.fk_FileID = Files.FileID WHERE Files.fk_CaseManagerID = '" & sessionUserID & "' AND fk_ErrorTypeID = '19' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                      "   PercentOfReviewsWithSpecialAdmissionErrors = ROUND((((SELECT COUNT(DISTINCT(fk_FileID)) FROM SpecialCaseErrors INNER JOIN Files ON SpecialCaseErrors.fk_FileID = Files.FileID WHERE Files.fk_CaseManagerID = '" & sessionUserID & "' AND fk_ErrorTypeID = '19' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                      "                                                ISNULL(NULLIF((SELECT COUNT(FileID) FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND fk_ReviewTypeID = '7'),0),1)), 3), " &
                                      "" &
                                      "   TotalNumberOfReviewsWithDocumentErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '18' AND fk_ErrorStaffID = '" & sessionUserID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "')," &
                                      "   PercentOfReviewsWithDocumentErrors = ROUND((((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_ProcessTypeID = '18' AND fk_ErrorStaffID = '" & sessionUserID & "' AND Files.ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "') * 100.0) / " &
                                      "                                        ISNULL(NULLIF((SELECT COUNT(FileID) FROM Files WHERE fk_CaseManagerID = '" & sessionUserID & "' AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "'),0),1)), 3) " &
                                      "" &
                                      "FROM Files   " &
                                      "WHERE FileID != '0' AND fk_CaseManagerID = '" & sessionUserID & "'"

                If Not String.IsNullOrEmpty(reviewDateBeginUnconverted) And Not String.IsNullOrEmpty(reviewDateEndUnconverted) Then
                    sql += " AND ReviewDate BETWEEN '" + reviewDateBeginConverted + "' AND '" + reviewDateEndConverted + "' "
                End If

                SqlStatisticalReview.SelectCommand = sql
                SqlStatisticalReview.DataBind()
                Summary.DataBind()
                Composition.DataBind()
        End Select
    End Sub

    Private Function ConvertStringFormatDatetoSqlDate(ByVal dateToConvert As String) As String
        Dim dateParsedArray() As String = ParseDate(dateToConvert)
        Dim month As Integer = Integer.Parse(dateParsedArray(0))
        Dim day As String = dateParsedArray(1)
        Dim year As String = dateParsedArray(2)
        Dim monthAbbrevName As String = MonthName(month, True)

        day = " " + day.Trim()
        year = " " + year.Trim()

        Return String.Concat(monthAbbrevName, day, year)
    End Function

    Public Sub DisplayListingsBasedOnHousingSpecialist(ByVal fileStaffID As Integer)
        Dim sql As String = "SELECT COUNT(FileID) AS TotalReviews, " &
                              "   TotalReviewsWithErrors = (SELECT COUNT(DISTINCT(fk_FileID))  " &
                              "                             FROM FileErrors WHERE fk_ErrorStaffID = '" & fileStaffID & "'), " &
                              "   TotalReviewsWithErrorsPercent = ROUND((((SELECT COUNT(DISTINCT(fk_FileID)) " &
                              "                                   FROM FileErrors WHERE fk_ErrorStaffID = '" & fileStaffID & "') * 100.0) / " &
                              "                                   ISNULL(NULLIF((SELECT COUNT(FileID) FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "'),0),1)), 3), " &
                              "   TotalReviewsWithNoErrors = ((SELECT COUNT(FileID) FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "') - " &
                              "                               (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors WHERE fk_ErrorStaffID = '" & fileStaffID & "')), " &
                              "   TotalReviewsWithNoErrorsPercent = ROUND(((((SELECT COUNT(FileID) FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "') - " &
                              "                                     (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors WHERE fk_ErrorStaffID = '" & fileStaffID & "'))  * 100.0) / " &
                              "                                     ISNULL(NULLIF((SELECT COUNT(FileID) FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "'),0),1)), 3),  " &
                              "   TotalNumberOfPendingErrors = ((SELECT COUNT(fk_FileID) FROM FileErrors WHERE Status = 'Pending' AND fk_ErrorStaffID = '" & fileStaffID & "')), " &
                              "   TotalNumberOfCompleteErrors = ((SELECT COUNT(fk_FileID) FROM FileErrors WHERE Status = 'Complete' AND fk_ErrorStaffID = '" & fileStaffID & "')), " &
                              "   TotalNumberOfAllErrors = (SELECT COUNT(fk_FileID) FROM FileErrors WHERE fk_ErrorStaffID = '" & fileStaffID & "'), " &
                              "" &
                              "    TotalNumberOfNoticeTypeError = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '1' AND fk_ErrorStaffID = '" & fileStaffID & "')," &
                              "    TotalNumberOfNoticeTypeWarning = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '2' AND fk_ErrorStaffID = '" & fileStaffID & "')," &
                              "    TotalNumberOfNoticeTypeMissing = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '3' AND fk_ErrorStaffID = '" & fileStaffID & "'), " &
                              "    TotalNumberOfNoticeTypeNoError = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '4' AND fk_ErrorStaffID = '" & fileStaffID & "')," &
                              "    TotalNumberOfNoticeTypeOther = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '5' AND fk_ErrorStaffID = '" & fileStaffID & "'), " &
                              "    TotalNumberOfNoticeTypeIncome = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '6' AND fk_ErrorStaffID = '" & fileStaffID & "')," &
                              "    TotalNumberOfNoticeTypeAdjustedIncome = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '7' AND fk_ErrorStaffID = '" & fileStaffID & "')," &
                              "    TotalNumberOfNoticeTypePaymentStandard = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '8' AND fk_ErrorStaffID = '" & fileStaffID & "')," &
                              "    TotalNumberOfNoticeTypeUtilityAllowance = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '9' AND fk_ErrorStaffID = '" & fileStaffID & "')," &
                              "    TotalNumberOfNoticeTypeContractRent = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '10' AND fk_ErrorStaffID = '" & fileStaffID & "')," &
                              "    TotalNumberOfNoticeTypeIncomeOrAdjustedRent = (SELECT COUNT(fk_FileID) FROM FileErrors INNER JOIN Files ON Files.FileID = FileErrors.fk_FileID WHERE fk_NoticeTypeID = '11' AND fk_ErrorStaffID = '" & fileStaffID & "')," &
                              "" &
                              "   TotalNumberOfReviewsWithVerification = (SELECT COUNT(*) AS NumberOfReviewsWithVerificationType FROM " &
                              "                                          (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID IN " &
                              "                                          (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '1')) Files),  " &
                              "   TotalNumberOfReviewsWithVerificationErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors WHERE fk_ProcessTypeID = '1' AND fk_ErrorStaffID = '" & fileStaffID & "')," &
                              "	PercentOfReviewsWithVerificationErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors WHERE fk_ProcessTypeID = '1' AND fk_ErrorStaffID = '" & fileStaffID & "') * 100.0) / " &
                              "                                            ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithVerificationType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID IN " &
                              "                                            (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '1')) Files),0),1),3), " &
                              "" &
                              "   TotalNumberOfReviewsWithCalculation = (SELECT COUNT(*) AS NumberOfReviewsWithCalculationType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID IN " &
                              "                                         (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '2')) Files)," &
                              "   TotalNumberOfReviewsWithCalculationErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors WHERE fk_ProcessTypeID = '2' AND fk_ErrorStaffID = '" & fileStaffID & "')," &
                              "   PercentOfReviewsWithCalculationErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors WHERE fk_ProcessTypeID = '2' AND fk_ErrorStaffID = '" & fileStaffID & "') * 100.0) / " &
                              "                                           ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithCalculationType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND  fk_ReviewTypeID IN " &
                              "                                           (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '2')) Files),0),1),3), " &
                              "" &
                              "   TotalNumberOfReviewsWithPaymentStandard = (SELECT COUNT(*) AS NumberOfReviewsWithPaymentStandardType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID IN " &
                              "                                             (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '3')) Files), " &
                              "   TotalNumberOfReviewsWithPaymentStandardErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors WHERE fk_ProcessTypeID = '3' AND fk_ErrorStaffID = '" & fileStaffID & "')," &
                              "	PercentOfReviewsWithPaymentStandardErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors WHERE fk_ProcessTypeID = '3' AND fk_ErrorStaffID = '" & fileStaffID & "') * 100.0) / " &
                              "                                               ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithPaymentStandardType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID IN " &
                              "                                               (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '3')) Files),0),1),3), " &
                              "" &
                              "   TotalNumberOfReviewsWithUtilityAllowance = (SELECT COUNT(*) AS NumberOfReviewsWithUtilityAllowance FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID IN " &
                              "                                              (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '4')) Files), " &
                              "   TotalNumberOfReviewsWithUtilityAllowanceErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors WHERE fk_ProcessTypeID = '4' AND fk_ErrorStaffID = '" & fileStaffID & "')," &
                              "   PercentOfReviewsWithUtilityAllowanceErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors WHERE fk_ProcessTypeID = '4' AND fk_ErrorStaffID = '" & fileStaffID & "') * 100.0) / " &
                              "                                                ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithUtilityAllowanceType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID IN " &
                              "                                               (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '4')) Files),0),1),3), " &
                              "" &
                              "	TotalNumberOfReviewsWithTenantRent = (SELECT COUNT(*) AS NumberOfReviewsWithTenantRent FROM	(SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID IN " &
                              "                                        (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '5')) Files), " &
                              "   TotalNumberOfReviewsWithTenantRentErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors WHERE fk_ProcessTypeID = '5' AND fk_ErrorStaffID = '" & fileStaffID & "'), " &
                              "   PercentOfReviewsWithTenantRentErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors WHERE fk_ProcessTypeID = '5' AND fk_ErrorStaffID = '" & fileStaffID & "') * 100.0) / " &
                              "                                          ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithTenantRentType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID IN " &
                              "                                          (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '5')) Files),0),1),3), " &
                              "" &
                              "   TotalNumberOfReviewsWithOccupanyStandard = (SELECT COUNT(*) AS NumberOfReviewsWithOccupanyStandard FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID IN " &
                              "                                              (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '6')) Files),  " &
                              "   TotalNumberOfReviewsWithOccupanyStandardErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors WHERE fk_ProcessTypeID = '6' AND fk_ErrorStaffID = '" & fileStaffID & "'), " &
                              "   PercentOfReviewsWithOccupanyStandardErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors WHERE fk_ProcessTypeID = '6' AND fk_ErrorStaffID = '" & fileStaffID & "') * 100.0) / " &
                              "                                                ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithOccupanyStandardType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID IN " &
                              "                                                (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '6')) Files),0),1),3), " &
                              "" &
                              "   TotalNumberOfReviewsWithAnnualReexamination = (SELECT COUNT(*) AS NumberOfReviewsWithAnnualReexamination FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID IN " &
                              "                                                (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '7')) Files), " &
                              "   TotalNumberOfReviewsWithAnnualReexaminationErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors WHERE fk_ProcessTypeID = '7' AND fk_ErrorStaffID = '" & fileStaffID & "')," &
                              "   PercentOfReviewsWithAnnualReexaminationErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors WHERE fk_ProcessTypeID = '7' AND fk_ErrorStaffID = '" & fileStaffID & "') * 100.0) / " &
                              "                                                   ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithAnnualReexaminationType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID IN " &
                              "                                                   (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '7')) Files),0),1),3)," &
                              "" &
                              "   TotalNumberOfReviewsWithInterimReexamination = (SELECT COUNT(*) AS NumberOfReviewsWithInterimReexamination FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID IN " &
                              "                                                 (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '8')) Files)," &
                              "   TotalNumberOfReviewsWithInterimReexaminationErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors WHERE fk_ProcessTypeID = '8' AND fk_ErrorStaffID = '" & fileStaffID & "'), " &
                              "   PercentOfReviewsWithInterimReexaminationErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors	WHERE fk_ProcessTypeID = '8' AND fk_ErrorStaffID = '" & fileStaffID & "') * 100.0) / " &
                              "                                                    ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithInterimReexaminationType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID IN " &
                              "                                                    (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '8')) Files),0),1),3)," &
                              "" &
                              "   TotalNumberOfReviewsWithMoves = (SELECT COUNT(*) AS NumberOfReviewsWithMoves FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID IN " &
                              "                                   (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '9')) Files)," &
                              "   TotalNumberOfReviewsWithMovesErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors WHERE fk_ProcessTypeID = '9' AND fk_ErrorStaffID = '" & fileStaffID & "'), " &
                              "   PercentOfReviewsWithMovesErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors WHERE fk_ProcessTypeID = '9' AND fk_ErrorStaffID = '" & fileStaffID & "') * 100.0) / " &
                              "                                     ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithMovesType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID IN " &
                              "                                     (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '9')) Files),0),1),3), " &
                              "" &
                              "   TotalNumberOfReviewsWithChangeInFamilyComposition = (SELECT COUNT(*) AS NumberOfReviewsWithChangeInFamilyComposition FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID IN " &
                              "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '10')) Files), " &
                              "   TotalNumberOfReviewsWithChangeInFamilyCompositionErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors WHERE fk_ProcessTypeID = '10' AND fk_ErrorStaffID = '" & fileStaffID & "'), " &
                              "   PercentOfReviewsWithChangeInFamilyCompositionErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors WHERE fk_ProcessTypeID = '10' AND fk_ErrorStaffID = '" & fileStaffID & "') * 100.0) / " &
                              "                                                         ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithChangeInFamilyCompositionType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID IN " &
                              "                                                         (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '10')) Files),0),1),3), " &
                              "" &
                              "   TotalNumberOfReviewsWithEligibilityAndScreening = (SELECT COUNT(*) AS NumberOfReviewsWithEligibilityAndScreening FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID IN " &
                              "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '11')) Files), " &
                              "   TotalNumberOfReviewsWithEligibilityAndScreeningErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors WHERE fk_ProcessTypeID = '11' AND fk_ErrorStaffID = '" & fileStaffID & "'), " &
                              "   PercentOfReviewsWithEligibilityAndScreeningErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors WHERE fk_ProcessTypeID = '11' AND fk_ErrorStaffID = '" & fileStaffID & "') * 100.0) / " &
                              "                                                       ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithEligibilityAndScreeningType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID IN " &
                              "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '11')) Files),0),1),3), " &
                              "" &
                              "   TotalNumberOfReviewsWithLeasing =                   (SELECT COUNT(*) AS NumberOfReviewsWithLeasing FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID IN " &
                              "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '12')) Files), " &
                              "   TotalNumberOfReviewsWithLeasingErrors =             (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors WHERE fk_ProcessTypeID = '12' AND fk_ErrorStaffID = '" & fileStaffID & "'), " &
                              "   PercentOfReviewsWithLeasingErrors =                 ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors WHERE fk_ProcessTypeID = '12' AND fk_ErrorStaffID = '" & fileStaffID & "') * 100.0) / " &
                              "                                                       ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithLeasingType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID IN " &
                              "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '12')) Files),0),1),3), " &
                              "" &
                              "   TotalNumberOfReviewsWithDataEntry =                 (SELECT COUNT(*) AS NumberOfReviewsWithDataEntry FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID IN " &
                              "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '13')) Files), " &
                              "   TotalNumberOfReviewsWithDataEntryErrors =           (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors WHERE fk_ProcessTypeID = '13' AND fk_ErrorStaffID = '" & fileStaffID & "'), " &
                              "   PercentOfReviewsWithDataEntryErrors =               ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors WHERE fk_ProcessTypeID = '13' AND fk_ErrorStaffID = '" & fileStaffID & "') * 100.0) / " &
                              "                                                       ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithDataEntryType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID IN " &
                              "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '13')) Files),0),1),3), " &
                              "" &
                              "   TotalNumberOfReviewsWithOther =                     (SELECT COUNT(*) AS NumberOfReviewsWithOther FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID IN " &
                              "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '21')) Files), " &
                              "   TotalNumberOfReviewsWithOtherErrors =               (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors WHERE fk_ProcessTypeID = '21' AND fk_ErrorStaffID = '" & fileStaffID & "'), " &
                              "   PercentOfReviewsWithOtherErrors =                   ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors WHERE fk_ProcessTypeID = '21' AND fk_ErrorStaffID = '" & fileStaffID & "') * 100.0) / " &
                              "                                                       ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithOtherType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID IN " &
                              "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '21')) Files),0),1),3), " &
                              "" &
                              "   TotalNumberOfReviewsWithSelectionFromTheWaitlist =  (SELECT COUNT(*) AS NumberOfReviewsWithSelectionFromTheWaitlist FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID IN " &
                              "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '22')) Files), " &
                              "   TotalNumberOfReviewsWithSelectionFromTheWaitlistErrors =  (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors WHERE fk_ProcessTypeID = '22' AND fk_ErrorStaffID = '" & fileStaffID & "'), " &
                              "   PercentOfReviewsWithSelectionFromTheWaitlistErrors = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors WHERE fk_ProcessTypeID = '22' AND fk_ErrorStaffID = '" & fileStaffID & "') * 100.0) / " &
                              "                                                       ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithSelectionFromTheWaitlistType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID IN " &
                              "                                                       (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '22')) Files),0),1),3), " &
                              "" &
                              "   TotalNumberOfReviewsWithReasonableRent =  (SELECT COUNT(*) AS NumberOfReviewsWithReasonableRent FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID IN " &
                              "                                             (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '15')) Files), " &
                              "   TotalNumberOfReviewsWithReasonableRentErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors WHERE fk_ProcessTypeID = '15' AND fk_ErrorStaffID = '" & fileStaffID & "'), " &
                              "   PercentOfReviewsWithReasonableRentErrors  = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors WHERE fk_ProcessTypeID = '15' AND fk_ErrorStaffID = '" & fileStaffID & "') * 100.0) / " &
                              "                                               ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithReasonableRentType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID IN " &
                              "                                               (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '15')) Files),0),1),3), " &
                              "" &
                              "   TotalNumberOfReviewsWithPortability = (SELECT COUNT(*) AS NumberOfReviewsWithPortability FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID IN " &
                              "                                         (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '16')) Files), " &
                              "   TotalNumberOfReviewsWithPortabilityErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors WHERE fk_ProcessTypeID = '16' AND fk_ErrorStaffID = '" & fileStaffID & "'), " &
                              "   PercentOfReviewsWithPortabilityErrors  = ROUND(((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors WHERE fk_ProcessTypeID = '16' AND fk_ErrorStaffID = '" & fileStaffID & "') * 100.0) / " &
                              "                                            ISNULL(NULLIF((SELECT COUNT(*) AS NumberOfReviewsWithPortabilityType FROM (SELECT FileID FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID IN " &
                              "                                            (SELECT fk_ReviewTypeID FROM ReviewTypesProcesses WHERE fk_ProcessTypeID = '16')) Files),0),1),3), " &
                              "" &
                              "   TotalNumberOfReviewsWithLotteryNumber = (SELECT COUNT(FileID) FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID = '7'), " &
                              "   TotalNumberOfReviewsWithLotteryNumberErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM LotteryNumberErrors INNER JOIN Files ON LotteryNumberErrors.fk_FileID = Files.FileID WHERE Files.fk_CaseManagerID = '" & fileStaffID & "'), " &
                              "   PercentOfReviewsWithLotteryNumberErrors = ROUND((((SELECT COUNT(DISTINCT(fk_FileID)) FROM LotteryNumberErrors INNER JOIN Files ON LotteryNumberErrors.fk_FileID = Files.FileID  WHERE Files.fk_CaseManagerID = '" & fileStaffID & "') * 100.0) / " &
                              "                                             ISNULL(NULLIF((SELECT COUNT(FileID) FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND  fk_ReviewTypeID = '7'),0),1)), 3), " &
                              "" &
                              "   TotalNumberOfReviewsWithPortIn = (SELECT COUNT(FileID) FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID = '7'), " &
                              "   TotalNumberOfReviewsWithPortInErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM SpecialCaseErrors INNER JOIN Files ON SpecialCaseErrors.fk_FileID = Files.FileID WHERE Files.fk_CaseManagerID = '" & fileStaffID & "' AND fk_ErrorTypeID = '20')," &
                              "   PercentOfReviewsWithPortInErrors = ROUND((((SELECT COUNT(DISTINCT(fk_FileID)) FROM SpecialCaseErrors INNER JOIN Files ON SpecialCaseErrors.fk_FileID = Files.FileID WHERE Files.fk_CaseManagerID = '" & fileStaffID & "' AND fk_ErrorTypeID = '20') * 100.0) / " &
                              "                                                ISNULL(NULLIF((SELECT COUNT(FileID) FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID = '7'),0),1)), 3), " &
                              "" &
                              "   TotalNumberOfReviewsWithSpecialAdmission = (SELECT COUNT(FileID) FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID = '7'), " &
                              "   TotalNumberOfReviewsWithSpecialAdmissionErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM SpecialCaseErrors INNER JOIN Files ON SpecialCaseErrors.fk_FileID = Files.FileID WHERE Files.fk_CaseManagerID = '" & fileStaffID & "' AND fk_ErrorTypeID = '19')," &
                              "   PercentOfReviewsWithSpecialAdmissionErrors = ROUND((((SELECT COUNT(DISTINCT(fk_FileID)) FROM SpecialCaseErrors INNER JOIN Files ON SpecialCaseErrors.fk_FileID = Files.FileID WHERE Files.fk_CaseManagerID = '" & fileStaffID & "' AND fk_ErrorTypeID = '19') * 100.0) / " &
                              "                                                ISNULL(NULLIF((SELECT COUNT(FileID) FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "' AND fk_ReviewTypeID = '7'),0),1)), 3), " &
                              "" &
                              "   TotalNumberOfReviewsWithDocumentErrors = (SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors WHERE fk_ProcessTypeID = '18' AND fk_ErrorStaffID = '" & fileStaffID & "')," &
                              "   PercentOfReviewsWithDocumentErrors = ROUND((((SELECT COUNT(DISTINCT(fk_FileID)) FROM FileErrors WHERE fk_ProcessTypeID = '18' AND fk_ErrorStaffID = '" & fileStaffID & "') * 100.0) / " &
                              "                                        ISNULL(NULLIF((SELECT COUNT(FileID) FROM Files WHERE fk_CaseManagerID = '" & fileStaffID & "'),0),1)), 3) " &
                              "" &
                              "FROM Files   " &
                              "WHERE FileID != '0' AND fk_CaseManagerID = '" & fileStaffID & "'"


        SqlStatisticalReview.SelectCommand = sql
        SqlStatisticalReview.DataBind()
        Summary.DataBind()
        Composition.DataBind()
    End Sub

    Protected Sub ExportToExcel(ByVal sender As Object, ByVal e As EventArgs) Handles btnExportToExcel.Click
        Response.Clear()
        Response.Buffer = True
        Response.AddHeader("content-disposition", "attachment;filename=StatisticalReportExport.xls")
        Response.Charset = ""
        Response.ContentType = "application/vnd.ms-excel"
        Using writeContent As New StringWriter()
            Dim writeHtmlContent As New HtmlTextWriter(writeContent)
            Me.BindGridWithFilters()

            Summary.RenderControl(writeHtmlContent)
            Composition.RenderControl(writeHtmlContent)
            Response.Output.Write(writeContent.ToString())
            Response.Flush()
            Response.[End]()
        End Using
    End Sub

    Protected Sub FilterReport(ByVal sender As Object, ByVal e As EventArgs) Handles btnFilterReport.Click
        Me.BindGridWithFilters()
    End Sub

    Public Function GetUserRoleID(ByVal sessionUserID As Integer) As Integer
        Dim roleID As Integer

        conn.Open()
        Dim query As New SqlCommand("SELECT fk_RoleID FROM Users WHERE UserID  = '" & sessionUserID & "'", conn)
        Dim reader As SqlDataReader = query.ExecuteReader()

        While reader.Read
            roleID = CStr(reader("fk_RoleID"))
        End While
        conn.Close()

        Return roleID
    End Function

    Public Function GetSessionUserID() As Integer
        'Get user id from session to dictate which form will display
        Dim sessionUserID As String
        If Not Web.HttpContext.Current.Session("SessionUserID") Is Nothing Then
            sessionUserID = Web.HttpContext.Current.Session("SessionUserID").ToString()
        End If

        If sessionUserID = Nothing Then
            sessionUserID = Request.QueryString("SessionUserID")
            Web.HttpContext.Current.Session("SessionUserID") = sessionUserID
        End If

        Return Convert.ToInt32(sessionUserID)
    End Function

    Private Function ParseDate(ByVal dateToParse As String) As String()
        Dim dateSegments() As String = dateToParse.Split("/")
        Return dateSegments
    End Function

    Public Sub SetFiltersToAll()
        Group.AppendDataBoundItems = True
        Group.Items.Insert(0, New ListItem("ALL", 0))

        FileStaff.AppendDataBoundItems = True
        FileStaff.Items.Insert(0, New ListItem("ALL", 0))

        Auditor.AppendDataBoundItems = True
        Auditor.Items.Insert(0, New ListItem("ALL", 0))
    End Sub
End Class